/* valaccodedelegatemodule.c generated by valac, the Vala compiler
 * generated from valaccodedelegatemodule.vala, do not modify */

/* valaccodedelegatemodule.vala
 *
 * Copyright (C) 2006-2010  Jürg Billeter
 * Copyright (C) 2006-2008  Raffaele Sandrini
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.

 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.

 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
 *
 * Author:
 * 	Jürg Billeter <j@bitron.ch>
 *	Raffaele Sandrini <raffaele@sandrini.ch>
 */

#include <glib.h>
#include <glib-object.h>
#include <vala.h>
#include <valagee.h>
#include <valaccode.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>


#define VALA_TYPE_CCODE_BASE_MODULE (vala_ccode_base_module_get_type ())
#define VALA_CCODE_BASE_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_BASE_MODULE, ValaCCodeBaseModule))
#define VALA_CCODE_BASE_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_BASE_MODULE, ValaCCodeBaseModuleClass))
#define VALA_IS_CCODE_BASE_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_BASE_MODULE))
#define VALA_IS_CCODE_BASE_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_BASE_MODULE))
#define VALA_CCODE_BASE_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_BASE_MODULE, ValaCCodeBaseModuleClass))

typedef struct _ValaCCodeBaseModule ValaCCodeBaseModule;
typedef struct _ValaCCodeBaseModuleClass ValaCCodeBaseModuleClass;
typedef struct _ValaCCodeBaseModulePrivate ValaCCodeBaseModulePrivate;

#define VALA_TYPE_CCODE_DECLARATION_SPACE (vala_ccode_declaration_space_get_type ())
#define VALA_CCODE_DECLARATION_SPACE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_DECLARATION_SPACE, ValaCCodeDeclarationSpace))
#define VALA_CCODE_DECLARATION_SPACE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_DECLARATION_SPACE, ValaCCodeDeclarationSpaceClass))
#define VALA_IS_CCODE_DECLARATION_SPACE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_DECLARATION_SPACE))
#define VALA_IS_CCODE_DECLARATION_SPACE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_DECLARATION_SPACE))
#define VALA_CCODE_DECLARATION_SPACE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_DECLARATION_SPACE, ValaCCodeDeclarationSpaceClass))

typedef struct _ValaCCodeDeclarationSpace ValaCCodeDeclarationSpace;
typedef struct _ValaCCodeDeclarationSpaceClass ValaCCodeDeclarationSpaceClass;

#define VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT (vala_ccode_base_module_emit_context_get_type ())
#define VALA_CCODE_BASE_MODULE_EMIT_CONTEXT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT, ValaCCodeBaseModuleEmitContext))
#define VALA_CCODE_BASE_MODULE_EMIT_CONTEXT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT, ValaCCodeBaseModuleEmitContextClass))
#define VALA_CCODE_BASE_MODULE_IS_EMIT_CONTEXT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT))
#define VALA_CCODE_BASE_MODULE_IS_EMIT_CONTEXT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT))
#define VALA_CCODE_BASE_MODULE_EMIT_CONTEXT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT, ValaCCodeBaseModuleEmitContextClass))

typedef struct _ValaCCodeBaseModuleEmitContext ValaCCodeBaseModuleEmitContext;
typedef struct _ValaCCodeBaseModuleEmitContextClass ValaCCodeBaseModuleEmitContextClass;

#define VALA_TYPE_CCODE_STRUCT_MODULE (vala_ccode_struct_module_get_type ())
#define VALA_CCODE_STRUCT_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_STRUCT_MODULE, ValaCCodeStructModule))
#define VALA_CCODE_STRUCT_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_STRUCT_MODULE, ValaCCodeStructModuleClass))
#define VALA_IS_CCODE_STRUCT_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_STRUCT_MODULE))
#define VALA_IS_CCODE_STRUCT_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_STRUCT_MODULE))
#define VALA_CCODE_STRUCT_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_STRUCT_MODULE, ValaCCodeStructModuleClass))

typedef struct _ValaCCodeStructModule ValaCCodeStructModule;
typedef struct _ValaCCodeStructModuleClass ValaCCodeStructModuleClass;
typedef struct _ValaCCodeStructModulePrivate ValaCCodeStructModulePrivate;

#define VALA_TYPE_CCODE_METHOD_MODULE (vala_ccode_method_module_get_type ())
#define VALA_CCODE_METHOD_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_METHOD_MODULE, ValaCCodeMethodModule))
#define VALA_CCODE_METHOD_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_METHOD_MODULE, ValaCCodeMethodModuleClass))
#define VALA_IS_CCODE_METHOD_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_METHOD_MODULE))
#define VALA_IS_CCODE_METHOD_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_METHOD_MODULE))
#define VALA_CCODE_METHOD_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_METHOD_MODULE, ValaCCodeMethodModuleClass))

typedef struct _ValaCCodeMethodModule ValaCCodeMethodModule;
typedef struct _ValaCCodeMethodModuleClass ValaCCodeMethodModuleClass;
typedef struct _ValaCCodeMethodModulePrivate ValaCCodeMethodModulePrivate;

#define VALA_TYPE_CCODE_CONTROL_FLOW_MODULE (vala_ccode_control_flow_module_get_type ())
#define VALA_CCODE_CONTROL_FLOW_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_CONTROL_FLOW_MODULE, ValaCCodeControlFlowModule))
#define VALA_CCODE_CONTROL_FLOW_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_CONTROL_FLOW_MODULE, ValaCCodeControlFlowModuleClass))
#define VALA_IS_CCODE_CONTROL_FLOW_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_CONTROL_FLOW_MODULE))
#define VALA_IS_CCODE_CONTROL_FLOW_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_CONTROL_FLOW_MODULE))
#define VALA_CCODE_CONTROL_FLOW_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_CONTROL_FLOW_MODULE, ValaCCodeControlFlowModuleClass))

typedef struct _ValaCCodeControlFlowModule ValaCCodeControlFlowModule;
typedef struct _ValaCCodeControlFlowModuleClass ValaCCodeControlFlowModuleClass;
typedef struct _ValaCCodeControlFlowModulePrivate ValaCCodeControlFlowModulePrivate;

#define VALA_TYPE_CCODE_MEMBER_ACCESS_MODULE (vala_ccode_member_access_module_get_type ())
#define VALA_CCODE_MEMBER_ACCESS_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_MEMBER_ACCESS_MODULE, ValaCCodeMemberAccessModule))
#define VALA_CCODE_MEMBER_ACCESS_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_MEMBER_ACCESS_MODULE, ValaCCodeMemberAccessModuleClass))
#define VALA_IS_CCODE_MEMBER_ACCESS_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_MEMBER_ACCESS_MODULE))
#define VALA_IS_CCODE_MEMBER_ACCESS_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_MEMBER_ACCESS_MODULE))
#define VALA_CCODE_MEMBER_ACCESS_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_MEMBER_ACCESS_MODULE, ValaCCodeMemberAccessModuleClass))

typedef struct _ValaCCodeMemberAccessModule ValaCCodeMemberAccessModule;
typedef struct _ValaCCodeMemberAccessModuleClass ValaCCodeMemberAccessModuleClass;
typedef struct _ValaCCodeMemberAccessModulePrivate ValaCCodeMemberAccessModulePrivate;

#define VALA_TYPE_CCODE_ASSIGNMENT_MODULE (vala_ccode_assignment_module_get_type ())
#define VALA_CCODE_ASSIGNMENT_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_ASSIGNMENT_MODULE, ValaCCodeAssignmentModule))
#define VALA_CCODE_ASSIGNMENT_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_ASSIGNMENT_MODULE, ValaCCodeAssignmentModuleClass))
#define VALA_IS_CCODE_ASSIGNMENT_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_ASSIGNMENT_MODULE))
#define VALA_IS_CCODE_ASSIGNMENT_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_ASSIGNMENT_MODULE))
#define VALA_CCODE_ASSIGNMENT_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_ASSIGNMENT_MODULE, ValaCCodeAssignmentModuleClass))

typedef struct _ValaCCodeAssignmentModule ValaCCodeAssignmentModule;
typedef struct _ValaCCodeAssignmentModuleClass ValaCCodeAssignmentModuleClass;
typedef struct _ValaCCodeAssignmentModulePrivate ValaCCodeAssignmentModulePrivate;

#define VALA_TYPE_CCODE_METHOD_CALL_MODULE (vala_ccode_method_call_module_get_type ())
#define VALA_CCODE_METHOD_CALL_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_METHOD_CALL_MODULE, ValaCCodeMethodCallModule))
#define VALA_CCODE_METHOD_CALL_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_METHOD_CALL_MODULE, ValaCCodeMethodCallModuleClass))
#define VALA_IS_CCODE_METHOD_CALL_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_METHOD_CALL_MODULE))
#define VALA_IS_CCODE_METHOD_CALL_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_METHOD_CALL_MODULE))
#define VALA_CCODE_METHOD_CALL_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_METHOD_CALL_MODULE, ValaCCodeMethodCallModuleClass))

typedef struct _ValaCCodeMethodCallModule ValaCCodeMethodCallModule;
typedef struct _ValaCCodeMethodCallModuleClass ValaCCodeMethodCallModuleClass;
typedef struct _ValaCCodeMethodCallModulePrivate ValaCCodeMethodCallModulePrivate;

#define VALA_TYPE_CCODE_ARRAY_MODULE (vala_ccode_array_module_get_type ())
#define VALA_CCODE_ARRAY_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_ARRAY_MODULE, ValaCCodeArrayModule))
#define VALA_CCODE_ARRAY_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_ARRAY_MODULE, ValaCCodeArrayModuleClass))
#define VALA_IS_CCODE_ARRAY_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_ARRAY_MODULE))
#define VALA_IS_CCODE_ARRAY_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_ARRAY_MODULE))
#define VALA_CCODE_ARRAY_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_ARRAY_MODULE, ValaCCodeArrayModuleClass))

typedef struct _ValaCCodeArrayModule ValaCCodeArrayModule;
typedef struct _ValaCCodeArrayModuleClass ValaCCodeArrayModuleClass;
typedef struct _ValaCCodeArrayModulePrivate ValaCCodeArrayModulePrivate;

#define VALA_TYPE_CCODE_DELEGATE_MODULE (vala_ccode_delegate_module_get_type ())
#define VALA_CCODE_DELEGATE_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_DELEGATE_MODULE, ValaCCodeDelegateModule))
#define VALA_CCODE_DELEGATE_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_DELEGATE_MODULE, ValaCCodeDelegateModuleClass))
#define VALA_IS_CCODE_DELEGATE_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_DELEGATE_MODULE))
#define VALA_IS_CCODE_DELEGATE_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_DELEGATE_MODULE))
#define VALA_CCODE_DELEGATE_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_DELEGATE_MODULE, ValaCCodeDelegateModuleClass))

typedef struct _ValaCCodeDelegateModule ValaCCodeDelegateModule;
typedef struct _ValaCCodeDelegateModuleClass ValaCCodeDelegateModuleClass;
typedef struct _ValaCCodeDelegateModulePrivate ValaCCodeDelegateModulePrivate;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _vala_collection_object_unref0(var) ((var == NULL) ? NULL : (var = (vala_collection_object_unref (var), NULL)))
#define _vala_ccode_node_unref0(var) ((var == NULL) ? NULL : (var = (vala_ccode_node_unref (var), NULL)))
#define _vala_code_node_unref0(var) ((var == NULL) ? NULL : (var = (vala_code_node_unref (var), NULL)))

struct _ValaCCodeBaseModule {
	ValaCodeGenerator parent_instance;
	ValaCCodeBaseModulePrivate * priv;
	ValaSymbol* root_symbol;
	ValaCCodeBaseModuleEmitContext* emit_context;
	ValaCCodeDeclarationSpace* header_declarations;
	ValaCCodeDeclarationSpace* internal_header_declarations;
	ValaCCodeDeclarationSpace* source_declarations;
	ValaCCodeFragment* source_signal_marshaller_declaration;
	ValaCCodeFragment* source_type_member_definition;
	ValaCCodeFragment* class_init_fragment;
	ValaCCodeFragment* base_init_fragment;
	ValaCCodeFragment* class_finalize_fragment;
	ValaCCodeFragment* base_finalize_fragment;
	ValaCCodeFragment* instance_init_fragment;
	ValaCCodeFragment* instance_finalize_fragment;
	ValaCCodeFragment* source_signal_marshaller_definition;
	ValaCCodeStruct* param_spec_struct;
	ValaCCodeStruct* closure_struct;
	ValaCCodeEnum* prop_enum;
	ValaCCodeFunction* function;
	ValaCCodeFragment* pre_statement_fragment;
	ValaSet* user_marshal_set;
	ValaSet* predefined_marshal_set;
	gint next_regex_id;
	gboolean in_constructor;
	gboolean in_static_or_class_context;
	gint next_coroutine_state;
	ValaDataType* void_type;
	ValaDataType* bool_type;
	ValaDataType* char_type;
	ValaDataType* uchar_type;
	ValaDataType* unichar_type;
	ValaDataType* short_type;
	ValaDataType* ushort_type;
	ValaDataType* int_type;
	ValaDataType* uint_type;
	ValaDataType* long_type;
	ValaDataType* ulong_type;
	ValaDataType* int8_type;
	ValaDataType* uint8_type;
	ValaDataType* int16_type;
	ValaDataType* uint16_type;
	ValaDataType* int32_type;
	ValaDataType* uint32_type;
	ValaDataType* int64_type;
	ValaDataType* uint64_type;
	ValaDataType* string_type;
	ValaDataType* regex_type;
	ValaDataType* float_type;
	ValaDataType* double_type;
	ValaTypeSymbol* gtype_type;
	ValaTypeSymbol* gobject_type;
	ValaErrorType* gerror_type;
	ValaClass* glist_type;
	ValaClass* gslist_type;
	ValaClass* gnode_type;
	ValaClass* gvaluearray_type;
	ValaTypeSymbol* gstringbuilder_type;
	ValaTypeSymbol* garray_type;
	ValaTypeSymbol* gbytearray_type;
	ValaTypeSymbol* gptrarray_type;
	ValaTypeSymbol* gthreadpool_type;
	ValaDataType* gquark_type;
	ValaStruct* gvalue_type;
	ValaClass* gvariant_type;
	ValaStruct* mutex_type;
	ValaTypeSymbol* type_module_type;
	ValaTypeSymbol* dbus_proxy_type;
	ValaTypeSymbol* dbus_object_type;
	gboolean in_plugin;
	char* module_init_param_name;
	gboolean gvaluecollector_h_needed;
	gboolean requires_array_free;
	gboolean requires_array_move;
	gboolean requires_array_length;
	gboolean requires_strcmp0;
	ValaSet* wrappers;
};

struct _ValaCCodeBaseModuleClass {
	ValaCodeGeneratorClass parent_class;
	void (*append_vala_array_free) (ValaCCodeBaseModule* self);
	void (*append_vala_array_move) (ValaCCodeBaseModule* self);
	void (*append_vala_array_length) (ValaCCodeBaseModule* self);
	gboolean (*generate_enum_declaration) (ValaCCodeBaseModule* self, ValaEnum* en, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_class_struct_declaration) (ValaCCodeBaseModule* self, ValaClass* cl, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_struct_declaration) (ValaCCodeBaseModule* self, ValaStruct* st, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_delegate_declaration) (ValaCCodeBaseModule* self, ValaDelegate* d, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_cparameters) (ValaCCodeBaseModule* self, ValaMethod* m, ValaCCodeDeclarationSpace* decl_space, ValaMap* cparam_map, ValaCCodeFunction* func, ValaCCodeFunctionDeclarator* vdeclarator, ValaMap* carg_map, ValaCCodeFunctionCall* vcall, gint direction);
	ValaCCodeExpression* (*get_dup_func_expression) (ValaCCodeBaseModule* self, ValaDataType* type, ValaSourceReference* source_reference, gboolean is_chainup);
	char* (*append_struct_array_free) (ValaCCodeBaseModule* self, ValaStruct* st);
	ValaCCodeExpression* (*get_unref_expression) (ValaCCodeBaseModule* self, ValaCCodeExpression* cvar, ValaDataType* type, ValaExpression* expr, gboolean is_macro_definition);
	void (*append_local_free) (ValaCCodeBaseModule* self, ValaSymbol* sym, ValaCCodeFragment* cfrag, gboolean stop_at_loop);
	char* (*get_delegate_target_cname) (ValaCCodeBaseModule* self, const char* delegate_cname);
	ValaCCodeExpression* (*get_delegate_target_cexpression) (ValaCCodeBaseModule* self, ValaExpression* delegate_expr, ValaCCodeExpression** delegate_target_destroy_notify);
	char* (*get_delegate_target_destroy_notify_cname) (ValaCCodeBaseModule* self, const char* delegate_cname);
	ValaCCodeExpression* (*get_ref_cexpression) (ValaCCodeBaseModule* self, ValaDataType* expression_type, ValaCCodeExpression* cexpr, ValaExpression* expr, ValaCodeNode* node);
	void (*generate_class_declaration) (ValaCCodeBaseModule* self, ValaClass* cl, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_interface_declaration) (ValaCCodeBaseModule* self, ValaInterface* iface, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_method_declaration) (ValaCCodeBaseModule* self, ValaMethod* m, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_error_domain_declaration) (ValaCCodeBaseModule* self, ValaErrorDomain* edomain, ValaCCodeDeclarationSpace* decl_space);
	ValaCCodeExpression* (*deserialize_expression) (ValaCCodeBaseModule* self, ValaCCodeFragment* fragment, ValaDataType* type, ValaCCodeExpression* variant_expr, ValaCCodeExpression* expr);
	ValaCCodeExpression* (*serialize_expression) (ValaCCodeBaseModule* self, ValaCCodeFragment* fragment, ValaDataType* type, ValaCCodeExpression* expr);
	ValaCCodeExpression* (*get_implicit_cast_expression) (ValaCCodeBaseModule* self, ValaCCodeExpression* source_cexpr, ValaDataType* expression_type, ValaDataType* target_type, ValaExpression* expr);
	gboolean (*is_gobject_property) (ValaCCodeBaseModule* self, ValaProperty* prop);
	char* (*get_custom_creturn_type) (ValaCCodeBaseModule* self, ValaMethod* m);
	void (*generate_dynamic_method_wrapper) (ValaCCodeBaseModule* self, ValaDynamicMethod* method);
	gboolean (*method_has_wrapper) (ValaCCodeBaseModule* self, ValaMethod* method);
	ValaCCodeExpression* (*get_construct_property_assignment) (ValaCCodeBaseModule* self, ValaCCodeConstant* canonical_cconstant, ValaDataType* property_type, ValaCCodeExpression* value);
	ValaCCodeFunctionCall* (*get_param_spec) (ValaCCodeBaseModule* self, ValaProperty* prop);
	ValaCCodeFunctionCall* (*get_signal_creation) (ValaCCodeBaseModule* self, ValaSignal* sig, ValaTypeSymbol* type);
	ValaCCodeFragment* (*register_dbus_info) (ValaCCodeBaseModule* self, ValaObjectTypeSymbol* bindable);
	char* (*get_dynamic_property_getter_cname) (ValaCCodeBaseModule* self, ValaDynamicProperty* node);
	char* (*get_dynamic_property_setter_cname) (ValaCCodeBaseModule* self, ValaDynamicProperty* node);
	char* (*get_dynamic_signal_cname) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	char* (*get_dynamic_signal_connect_wrapper_name) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	char* (*get_dynamic_signal_connect_after_wrapper_name) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	char* (*get_dynamic_signal_disconnect_wrapper_name) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	void (*generate_marshaller) (ValaCCodeBaseModule* self, ValaList* params, ValaDataType* return_type, gboolean dbus);
	char* (*get_marshaller_function) (ValaCCodeBaseModule* self, ValaList* params, ValaDataType* return_type, const char* prefix, gboolean dbus);
	char* (*get_array_length_cname) (ValaCCodeBaseModule* self, const char* array_cname, gint dim);
	char* (*get_parameter_array_length_cname) (ValaCCodeBaseModule* self, ValaFormalParameter* param, gint dim);
	ValaCCodeExpression* (*get_array_length_cexpression) (ValaCCodeBaseModule* self, ValaExpression* array_expr, gint dim);
	char* (*get_array_size_cname) (ValaCCodeBaseModule* self, const char* array_cname);
	ValaCCodeExpression* (*get_array_size_cexpression) (ValaCCodeBaseModule* self, ValaExpression* array_expr);
	void (*add_simple_check) (ValaCCodeBaseModule* self, ValaCodeNode* node, ValaCCodeFragment* cfrag, gboolean always_fails);
};

struct _ValaCCodeStructModule {
	ValaCCodeBaseModule parent_instance;
	ValaCCodeStructModulePrivate * priv;
};

struct _ValaCCodeStructModuleClass {
	ValaCCodeBaseModuleClass parent_class;
};

struct _ValaCCodeMethodModule {
	ValaCCodeStructModule parent_instance;
	ValaCCodeMethodModulePrivate * priv;
};

struct _ValaCCodeMethodModuleClass {
	ValaCCodeStructModuleClass parent_class;
	void (*generate_method_result_declaration) (ValaCCodeMethodModule* self, ValaMethod* m, ValaCCodeDeclarationSpace* decl_space, ValaCCodeFunction* cfunc, ValaMap* cparam_map, ValaMap* carg_map);
	void (*generate_parameter) (ValaCCodeMethodModule* self, ValaFormalParameter* param, ValaCCodeDeclarationSpace* decl_space, ValaMap* cparam_map, ValaMap* carg_map);
};

struct _ValaCCodeControlFlowModule {
	ValaCCodeMethodModule parent_instance;
	ValaCCodeControlFlowModulePrivate * priv;
};

struct _ValaCCodeControlFlowModuleClass {
	ValaCCodeMethodModuleClass parent_class;
};

struct _ValaCCodeMemberAccessModule {
	ValaCCodeControlFlowModule parent_instance;
	ValaCCodeMemberAccessModulePrivate * priv;
};

struct _ValaCCodeMemberAccessModuleClass {
	ValaCCodeControlFlowModuleClass parent_class;
};

struct _ValaCCodeAssignmentModule {
	ValaCCodeMemberAccessModule parent_instance;
	ValaCCodeAssignmentModulePrivate * priv;
};

struct _ValaCCodeAssignmentModuleClass {
	ValaCCodeMemberAccessModuleClass parent_class;
};

struct _ValaCCodeMethodCallModule {
	ValaCCodeAssignmentModule parent_instance;
	ValaCCodeMethodCallModulePrivate * priv;
};

struct _ValaCCodeMethodCallModuleClass {
	ValaCCodeAssignmentModuleClass parent_class;
};

struct _ValaCCodeArrayModule {
	ValaCCodeMethodCallModule parent_instance;
	ValaCCodeArrayModulePrivate * priv;
};

struct _ValaCCodeArrayModuleClass {
	ValaCCodeMethodCallModuleClass parent_class;
};

struct _ValaCCodeDelegateModule {
	ValaCCodeArrayModule parent_instance;
	ValaCCodeDelegateModulePrivate * priv;
};

struct _ValaCCodeDelegateModuleClass {
	ValaCCodeArrayModuleClass parent_class;
};


static gpointer vala_ccode_delegate_module_parent_class = NULL;

GType vala_ccode_base_module_get_type (void) G_GNUC_CONST;
gpointer vala_ccode_declaration_space_ref (gpointer instance);
void vala_ccode_declaration_space_unref (gpointer instance);
GParamSpec* vala_param_spec_ccode_declaration_space (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void vala_value_set_ccode_declaration_space (GValue* value, gpointer v_object);
void vala_value_take_ccode_declaration_space (GValue* value, gpointer v_object);
gpointer vala_value_get_ccode_declaration_space (const GValue* value);
GType vala_ccode_declaration_space_get_type (void) G_GNUC_CONST;
gpointer vala_ccode_base_module_emit_context_ref (gpointer instance);
void vala_ccode_base_module_emit_context_unref (gpointer instance);
GParamSpec* vala_ccode_base_module_param_spec_emit_context (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void vala_ccode_base_module_value_set_emit_context (GValue* value, gpointer v_object);
void vala_ccode_base_module_value_take_emit_context (GValue* value, gpointer v_object);
gpointer vala_ccode_base_module_value_get_emit_context (const GValue* value);
GType vala_ccode_base_module_emit_context_get_type (void) G_GNUC_CONST;
GType vala_ccode_struct_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_method_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_control_flow_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_member_access_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_assignment_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_method_call_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_array_module_get_type (void) G_GNUC_CONST;
GType vala_ccode_delegate_module_get_type (void) G_GNUC_CONST;
enum  {
	VALA_CCODE_DELEGATE_MODULE_DUMMY_PROPERTY
};
static void vala_ccode_delegate_module_real_generate_delegate_declaration (ValaCCodeBaseModule* base, ValaDelegate* d, ValaCCodeDeclarationSpace* decl_space);
gboolean vala_ccode_declaration_space_add_symbol_declaration (ValaCCodeDeclarationSpace* self, ValaSymbol* sym, const char* name);
void vala_ccode_base_module_generate_type_declaration (ValaCCodeBaseModule* self, ValaDataType* type, ValaCCodeDeclarationSpace* decl_space);
void vala_ccode_method_module_generate_parameter (ValaCCodeMethodModule* self, ValaFormalParameter* param, ValaCCodeDeclarationSpace* decl_space, ValaMap* cparam_map, ValaMap* carg_map);
char* vala_ccode_base_module_get_parameter_array_length_cname (ValaCCodeBaseModule* self, ValaFormalParameter* param, gint dim);
char* vala_ccode_base_module_get_delegate_target_cname (ValaCCodeBaseModule* self, const char* delegate_cname);
char* vala_ccode_base_module_get_variable_cname (ValaCCodeBaseModule* self, const char* name);
char* vala_ccode_base_module_get_array_length_cname (ValaCCodeBaseModule* self, const char* array_cname, gint dim);
void vala_ccode_declaration_space_add_type_definition (ValaCCodeDeclarationSpace* self, ValaCCodeNode* node);
static void vala_ccode_delegate_module_real_visit_delegate (ValaCodeVisitor* base, ValaDelegate* d);
void vala_ccode_base_module_generate_delegate_declaration (ValaCCodeBaseModule* self, ValaDelegate* d, ValaCCodeDeclarationSpace* decl_space);
static char* vala_ccode_delegate_module_real_get_delegate_target_cname (ValaCCodeBaseModule* base, const char* delegate_cname);
static ValaCCodeExpression* vala_ccode_delegate_module_real_get_delegate_target_cexpression (ValaCCodeBaseModule* base, ValaExpression* delegate_expr, ValaCCodeExpression** delegate_target_destroy_notify);
gint vala_ccode_base_module_get_block_id (ValaCCodeBaseModule* self, ValaBlock* b);
ValaBlock* vala_ccode_base_module_get_current_closure_block (ValaCCodeBaseModule* self);
ValaCCodeExpression* vala_ccode_base_module_get_variable_cexpression (ValaCCodeBaseModule* self, const char* name);
ValaDataType* vala_ccode_base_module_get_this_type (ValaCCodeBaseModule* self);
ValaCCodeExpression* vala_ccode_base_module_get_result_cexpression (ValaCCodeBaseModule* self, const char* cname);
ValaCCodeExpression* vala_ccode_base_module_get_dup_func_expression (ValaCCodeBaseModule* self, ValaDataType* type, ValaSourceReference* source_reference, gboolean is_chainup);
ValaCCodeExpression* vala_ccode_base_module_get_destroy_func_expression (ValaCCodeBaseModule* self, ValaDataType* type, gboolean is_chainup);
char* vala_ccode_base_module_get_delegate_target_destroy_notify_cname (ValaCCodeBaseModule* self, const char* delegate_cname);
ValaMethod* vala_ccode_base_module_get_current_method (ValaCCodeBaseModule* self);
ValaDataType* vala_ccode_base_module_get_data_type_for_symbol (ValaTypeSymbol* sym);
ValaCCodeNode* vala_ccode_base_module_get_ccodenode (ValaCCodeBaseModule* self, ValaCodeNode* node);
ValaCCodeExpression* vala_ccode_base_module_transform_expression (ValaCCodeBaseModule* self, ValaCCodeExpression* source_cexpr, ValaDataType* expression_type, ValaDataType* target_type, ValaExpression* expr);
static char* vala_ccode_delegate_module_real_get_delegate_target_destroy_notify_cname (ValaCCodeBaseModule* base, const char* delegate_cname);
static ValaCCodeExpression* vala_ccode_delegate_module_real_get_implicit_cast_expression (ValaCCodeBaseModule* base, ValaCCodeExpression* source_cexpr, ValaDataType* expression_type, ValaDataType* target_type, ValaExpression* expr);
static char* vala_ccode_delegate_module_generate_delegate_wrapper (ValaCCodeDelegateModule* self, ValaMethod* m, ValaDelegateType* dt, ValaExpression* expr);
ValaCCodeExpression* vala_ccode_base_module_get_implicit_cast_expression (ValaCCodeBaseModule* self, ValaCCodeExpression* source_cexpr, ValaDataType* expression_type, ValaDataType* target_type, ValaExpression* expr);
char* vala_ccode_base_module_get_dynamic_signal_cname (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
gboolean vala_ccode_base_module_add_wrapper (ValaCCodeBaseModule* self, const char* wrapper_name);
gint vala_ccode_base_module_get_param_pos (ValaCCodeBaseModule* self, double param_pos, gboolean ellipsis);
void vala_ccode_declaration_space_add_type_member_declaration (ValaCCodeDeclarationSpace* self, ValaCCodeNode* node);
static void vala_ccode_delegate_module_real_generate_parameter (ValaCCodeMethodModule* base, ValaFormalParameter* param, ValaCCodeDeclarationSpace* decl_space, ValaMap* cparam_map, ValaMap* carg_map);
ValaCCodeDelegateModule* vala_ccode_delegate_module_new (void);
ValaCCodeDelegateModule* vala_ccode_delegate_module_construct (GType object_type);
ValaCCodeArrayModule* vala_ccode_array_module_new (void);
ValaCCodeArrayModule* vala_ccode_array_module_construct (GType object_type);
static int _vala_strcmp0 (const char * str1, const char * str2);



static gpointer _vala_code_node_ref0 (gpointer self) {
	return self ? vala_code_node_ref (self) : NULL;
}


static void vala_ccode_delegate_module_real_generate_delegate_declaration (ValaCCodeBaseModule* base, ValaDelegate* d, ValaCCodeDeclarationSpace* decl_space) {
	ValaCCodeDelegateModule * self;
	char* _tmp0_;
	gboolean _tmp1_;
	char* return_type_cname;
	char* _tmp3_;
	gboolean _tmp4_;
	char* _tmp6_;
	ValaCCodeFunctionDeclarator* _tmp7_;
	ValaCCodeFunctionDeclarator* cfundecl;
	gboolean _tmp19_ = FALSE;
	ValaList* _tmp28_;
	gboolean _tmp29_;
	ValaCCodeTypeDefinition* ctypedef;
	self = (ValaCCodeDelegateModule*) base;
	g_return_if_fail (d != NULL);
	g_return_if_fail (decl_space != NULL);
	if ((_tmp1_ = vala_ccode_declaration_space_add_symbol_declaration (decl_space, (ValaSymbol*) d, _tmp0_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) d, FALSE)), _g_free0 (_tmp0_), _tmp1_)) {
		return;
	}
	return_type_cname = vala_data_type_get_cname (vala_delegate_get_return_type (d));
	if (vala_data_type_is_real_non_null_struct_type (vala_delegate_get_return_type (d))) {
		char* _tmp2_;
		return_type_cname = (_tmp2_ = g_strdup ("void"), _g_free0 (return_type_cname), _tmp2_);
	}
	if ((_tmp4_ = _vala_strcmp0 (return_type_cname, _tmp3_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) d, FALSE)) == 0, _g_free0 (_tmp3_), _tmp4_)) {
		char* _tmp5_;
		return_type_cname = (_tmp5_ = g_strdup ("GCallback"), _g_free0 (return_type_cname), _tmp5_);
	} else {
		vala_ccode_base_module_generate_type_declaration ((ValaCCodeBaseModule*) self, vala_delegate_get_return_type (d), decl_space);
	}
	cfundecl = (_tmp7_ = vala_ccode_function_declarator_new (_tmp6_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) d, FALSE)), _g_free0 (_tmp6_), _tmp7_);
	{
		ValaList* _tmp8_;
		ValaIterator* _tmp9_;
		ValaIterator* _param_it;
		_param_it = (_tmp9_ = vala_iterable_iterator ((ValaIterable*) (_tmp8_ = vala_delegate_get_parameters (d))), _vala_collection_object_unref0 (_tmp8_), _tmp9_);
		while (TRUE) {
			ValaFormalParameter* param;
			ValaHashMap* _tmp10_;
			gboolean _tmp11_ = FALSE;
			if (!vala_iterator_next (_param_it)) {
				break;
			}
			param = (ValaFormalParameter*) vala_iterator_get (_param_it);
			vala_ccode_method_module_generate_parameter ((ValaCCodeMethodModule*) self, param, decl_space, (ValaMap*) (_tmp10_ = vala_hash_map_new (G_TYPE_INT, NULL, NULL, VALA_TYPE_CCODE_FORMAL_PARAMETER, (GBoxedCopyFunc) vala_ccode_node_ref, vala_ccode_node_unref, g_direct_hash, g_direct_equal, g_direct_equal)), NULL);
			_vala_collection_object_unref0 (_tmp10_);
			vala_ccode_function_declarator_add_parameter (cfundecl, VALA_CCODE_FORMAL_PARAMETER (vala_code_node_get_ccodenode ((ValaCodeNode*) param)));
			if (!vala_formal_parameter_get_no_array_length (param)) {
				_tmp11_ = VALA_IS_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) param));
			} else {
				_tmp11_ = FALSE;
			}
			if (_tmp11_) {
				ValaArrayType* array_type;
				char* length_ctype;
				array_type = _vala_code_node_ref0 (VALA_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) param)));
				length_ctype = g_strdup ("int");
				if (vala_formal_parameter_get_direction (param) != VALA_PARAMETER_DIRECTION_IN) {
					char* _tmp12_;
					length_ctype = (_tmp12_ = g_strdup ("int*"), _g_free0 (length_ctype), _tmp12_);
				}
				{
					gint dim;
					dim = 1;
					{
						gboolean _tmp13_;
						_tmp13_ = TRUE;
						while (TRUE) {
							char* _tmp14_;
							ValaCCodeFormalParameter* _tmp15_;
							ValaCCodeFormalParameter* cparam;
							if (!_tmp13_) {
								dim++;
							}
							_tmp13_ = FALSE;
							if (!(dim <= vala_array_type_get_rank (array_type))) {
								break;
							}
							cparam = (_tmp15_ = vala_ccode_formal_parameter_new (_tmp14_ = vala_ccode_base_module_get_parameter_array_length_cname ((ValaCCodeBaseModule*) self, param, dim), length_ctype), _g_free0 (_tmp14_), _tmp15_);
							vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
							_vala_ccode_node_unref0 (cparam);
						}
					}
				}
				_g_free0 (length_ctype);
				_vala_code_node_unref0 (array_type);
			}
			if (VALA_IS_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param))) {
				ValaDelegateType* deleg_type;
				ValaDelegate* param_d;
				deleg_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param)));
				param_d = _vala_code_node_ref0 (vala_delegate_type_get_delegate_symbol (deleg_type));
				if (vala_delegate_get_has_target (param_d)) {
					char* _tmp16_;
					char* _tmp17_;
					ValaCCodeFormalParameter* _tmp18_;
					ValaCCodeFormalParameter* cparam;
					cparam = (_tmp18_ = vala_ccode_formal_parameter_new (_tmp17_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp16_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param))), "void*"), _g_free0 (_tmp17_), _g_free0 (_tmp16_), _tmp18_);
					vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
					_vala_ccode_node_unref0 (cparam);
				}
				_vala_code_node_unref0 (param_d);
				_vala_code_node_unref0 (deleg_type);
			}
			_vala_code_node_unref0 (param);
		}
		_vala_collection_object_unref0 (_param_it);
	}
	if (!vala_delegate_get_no_array_length (d)) {
		_tmp19_ = VALA_IS_ARRAY_TYPE (vala_delegate_get_return_type (d));
	} else {
		_tmp19_ = FALSE;
	}
	if (_tmp19_) {
		ValaArrayType* array_type;
		array_type = _vala_code_node_ref0 (VALA_ARRAY_TYPE (vala_delegate_get_return_type (d)));
		{
			gint dim;
			dim = 1;
			{
				gboolean _tmp20_;
				_tmp20_ = TRUE;
				while (TRUE) {
					char* _tmp21_;
					ValaCCodeFormalParameter* _tmp22_;
					ValaCCodeFormalParameter* cparam;
					if (!_tmp20_) {
						dim++;
					}
					_tmp20_ = FALSE;
					if (!(dim <= vala_array_type_get_rank (array_type))) {
						break;
					}
					cparam = (_tmp22_ = vala_ccode_formal_parameter_new (_tmp21_ = vala_ccode_base_module_get_array_length_cname ((ValaCCodeBaseModule*) self, "result", dim), "int*"), _g_free0 (_tmp21_), _tmp22_);
					vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
					_vala_ccode_node_unref0 (cparam);
				}
			}
		}
		_vala_code_node_unref0 (array_type);
	} else {
		if (VALA_IS_DELEGATE_TYPE (vala_delegate_get_return_type (d))) {
			ValaDelegateType* deleg_type;
			ValaDelegate* result_d;
			deleg_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_delegate_get_return_type (d)));
			result_d = _vala_code_node_ref0 (vala_delegate_type_get_delegate_symbol (deleg_type));
			if (vala_delegate_get_has_target (result_d)) {
				char* _tmp23_;
				ValaCCodeFormalParameter* _tmp24_;
				ValaCCodeFormalParameter* cparam;
				cparam = (_tmp24_ = vala_ccode_formal_parameter_new (_tmp23_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, "result"), "void**"), _g_free0 (_tmp23_), _tmp24_);
				vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
				_vala_ccode_node_unref0 (cparam);
			}
			_vala_code_node_unref0 (result_d);
			_vala_code_node_unref0 (deleg_type);
		} else {
			if (vala_data_type_is_real_non_null_struct_type (vala_delegate_get_return_type (d))) {
				char* _tmp25_;
				char* _tmp26_;
				ValaCCodeFormalParameter* _tmp27_;
				ValaCCodeFormalParameter* cparam;
				cparam = (_tmp27_ = vala_ccode_formal_parameter_new ("result", _tmp26_ = g_strdup_printf ("%s*", _tmp25_ = vala_data_type_get_cname (vala_delegate_get_return_type (d)))), _g_free0 (_tmp26_), _g_free0 (_tmp25_), _tmp27_);
				vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
				_vala_ccode_node_unref0 (cparam);
			}
		}
	}
	if (vala_delegate_get_has_target (d)) {
		ValaCCodeFormalParameter* cparam;
		cparam = vala_ccode_formal_parameter_new ("user_data", "void*");
		vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
		_vala_ccode_node_unref0 (cparam);
	}
	if ((_tmp29_ = vala_collection_get_size ((ValaCollection*) (_tmp28_ = vala_code_node_get_error_types ((ValaCodeNode*) d))) > 0, _vala_collection_object_unref0 (_tmp28_), _tmp29_)) {
		ValaCCodeFormalParameter* cparam;
		cparam = vala_ccode_formal_parameter_new ("error", "GError**");
		vala_ccode_function_declarator_add_parameter (cfundecl, cparam);
		_vala_ccode_node_unref0 (cparam);
	}
	ctypedef = vala_ccode_type_definition_new (return_type_cname, (ValaCCodeDeclarator*) cfundecl);
	vala_ccode_type_definition_set_deprecated (ctypedef, vala_symbol_get_deprecated ((ValaSymbol*) d));
	vala_ccode_declaration_space_add_type_definition (decl_space, (ValaCCodeNode*) ctypedef);
	_vala_ccode_node_unref0 (ctypedef);
	_vala_ccode_node_unref0 (cfundecl);
	_g_free0 (return_type_cname);
}


static void vala_ccode_delegate_module_real_visit_delegate (ValaCodeVisitor* base, ValaDelegate* d) {
	ValaCCodeDelegateModule * self;
	self = (ValaCCodeDelegateModule*) base;
	g_return_if_fail (d != NULL);
	vala_code_node_accept_children ((ValaCodeNode*) d, (ValaCodeVisitor*) self);
	vala_ccode_base_module_generate_delegate_declaration ((ValaCCodeBaseModule*) self, d, ((ValaCCodeBaseModule*) self)->source_declarations);
	if (!vala_symbol_is_internal_symbol ((ValaSymbol*) d)) {
		vala_ccode_base_module_generate_delegate_declaration ((ValaCCodeBaseModule*) self, d, ((ValaCCodeBaseModule*) self)->header_declarations);
	}
	if (!vala_symbol_is_private_symbol ((ValaSymbol*) d)) {
		vala_ccode_base_module_generate_delegate_declaration ((ValaCCodeBaseModule*) self, d, ((ValaCCodeBaseModule*) self)->internal_header_declarations);
	}
}


static char* vala_ccode_delegate_module_real_get_delegate_target_cname (ValaCCodeBaseModule* base, const char* delegate_cname) {
	ValaCCodeDelegateModule * self;
	char* result = NULL;
	self = (ValaCCodeDelegateModule*) base;
	g_return_val_if_fail (delegate_cname != NULL, NULL);
	result = g_strdup_printf ("%s_target", delegate_cname);
	return result;
}


static gpointer _vala_ccode_node_ref0 (gpointer self) {
	return self ? vala_ccode_node_ref (self) : NULL;
}


static ValaCCodeExpression* vala_ccode_delegate_module_real_get_delegate_target_cexpression (ValaCCodeBaseModule* base, ValaExpression* delegate_expr, ValaCCodeExpression** delegate_target_destroy_notify) {
	ValaCCodeDelegateModule * self;
	ValaCCodeExpression* result = NULL;
	gboolean is_out;
	ValaCCodeExpression* _tmp0_;
	gboolean expr_owned;
	self = (ValaCCodeDelegateModule*) base;
	g_return_val_if_fail (delegate_expr != NULL, NULL);
	if (delegate_target_destroy_notify != NULL) {
		*delegate_target_destroy_notify = NULL;
	}
	is_out = FALSE;
	*delegate_target_destroy_notify = (_tmp0_ = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL"), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp0_);
	if (VALA_IS_UNARY_EXPRESSION (delegate_expr)) {
		ValaUnaryExpression* unary_expr;
		gboolean _tmp1_ = FALSE;
		unary_expr = _vala_code_node_ref0 (VALA_UNARY_EXPRESSION (delegate_expr));
		if (vala_unary_expression_get_operator (unary_expr) == VALA_UNARY_OPERATOR_OUT) {
			_tmp1_ = TRUE;
		} else {
			_tmp1_ = vala_unary_expression_get_operator (unary_expr) == VALA_UNARY_OPERATOR_REF;
		}
		if (_tmp1_) {
			delegate_expr = vala_unary_expression_get_inner (unary_expr);
			is_out = TRUE;
		}
		_vala_code_node_unref0 (unary_expr);
	}
	expr_owned = vala_data_type_get_value_owned (vala_expression_get_value_type (delegate_expr));
	if (VALA_IS_REFERENCE_TRANSFER_EXPRESSION (delegate_expr)) {
		ValaReferenceTransferExpression* reftransfer_expr;
		reftransfer_expr = _vala_code_node_ref0 (VALA_REFERENCE_TRANSFER_EXPRESSION (delegate_expr));
		delegate_expr = vala_reference_transfer_expression_get_inner (reftransfer_expr);
		_vala_code_node_unref0 (reftransfer_expr);
	}
	if (VALA_IS_METHOD_CALL (delegate_expr)) {
		ValaMethodCall* invocation_expr;
		invocation_expr = _vala_code_node_ref0 (VALA_METHOD_CALL (delegate_expr));
		if (vala_expression_get_delegate_target_destroy_notify ((ValaExpression*) invocation_expr) != NULL) {
			ValaCCodeExpression* _tmp2_;
			*delegate_target_destroy_notify = (_tmp2_ = _vala_ccode_node_ref0 (vala_expression_get_delegate_target_destroy_notify ((ValaExpression*) invocation_expr)), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp2_);
		}
		result = _vala_ccode_node_ref0 (vala_expression_get_delegate_target ((ValaExpression*) invocation_expr));
		_vala_code_node_unref0 (invocation_expr);
		return result;
	} else {
		if (VALA_IS_LAMBDA_EXPRESSION (delegate_expr)) {
			ValaLambdaExpression* lambda;
			ValaDelegateType* delegate_type;
			lambda = _vala_code_node_ref0 (VALA_LAMBDA_EXPRESSION (delegate_expr));
			delegate_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_expression_get_target_type (delegate_expr)));
			if (vala_method_get_closure (vala_lambda_expression_get_method (lambda))) {
				gint block_id;
				char* _tmp3_;
				ValaCCodeExpression* _tmp4_;
				ValaCCodeExpression* delegate_target;
				gboolean _tmp5_ = FALSE;
				block_id = vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, vala_ccode_base_module_get_current_closure_block ((ValaCCodeBaseModule*) self));
				delegate_target = (_tmp4_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, _tmp3_ = g_strdup_printf ("_data%d_", block_id)), _g_free0 (_tmp3_), _tmp4_);
				if (expr_owned) {
					_tmp5_ = TRUE;
				} else {
					_tmp5_ = vala_delegate_type_get_is_called_once (delegate_type);
				}
				if (_tmp5_) {
					char* _tmp6_;
					ValaCCodeIdentifier* _tmp7_;
					ValaCCodeFunctionCall* _tmp8_;
					ValaCCodeFunctionCall* ref_call;
					ValaCCodeExpression* _tmp9_;
					char* _tmp10_;
					ValaCCodeExpression* _tmp11_;
					ref_call = (_tmp8_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp7_ = vala_ccode_identifier_new (_tmp6_ = g_strdup_printf ("block%d_data_ref", block_id)))), _vala_ccode_node_unref0 (_tmp7_), _g_free0 (_tmp6_), _tmp8_);
					vala_ccode_function_call_add_argument (ref_call, delegate_target);
					delegate_target = (_tmp9_ = _vala_ccode_node_ref0 ((ValaCCodeExpression*) ref_call), _vala_ccode_node_unref0 (delegate_target), _tmp9_);
					*delegate_target_destroy_notify = (_tmp11_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp10_ = g_strdup_printf ("block%d_data_unref", block_id)), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp11_);
					_g_free0 (_tmp10_);
					_vala_ccode_node_unref0 (ref_call);
				}
				result = delegate_target;
				_vala_code_node_unref0 (delegate_type);
				_vala_code_node_unref0 (lambda);
				return result;
			} else {
				gboolean _tmp12_ = FALSE;
				ValaDataType* _tmp13_;
				gboolean _tmp14_;
				if ((_tmp14_ = (_tmp13_ = vala_ccode_base_module_get_this_type ((ValaCCodeBaseModule*) self)) != NULL, _vala_code_node_unref0 (_tmp13_), _tmp14_)) {
					_tmp12_ = TRUE;
				} else {
					_tmp12_ = ((ValaCCodeBaseModule*) self)->in_constructor;
				}
				if (_tmp12_) {
					ValaCCodeExpression* delegate_target;
					gboolean _tmp15_ = FALSE;
					delegate_target = vala_ccode_base_module_get_result_cexpression ((ValaCCodeBaseModule*) self, "self");
					if (expr_owned) {
						_tmp15_ = TRUE;
					} else {
						_tmp15_ = vala_delegate_type_get_is_called_once (delegate_type);
					}
					if (_tmp15_) {
						ValaDataType* _tmp16_;
						gboolean _tmp17_;
						if ((_tmp17_ = (_tmp16_ = vala_ccode_base_module_get_this_type ((ValaCCodeBaseModule*) self)) != NULL, _vala_code_node_unref0 (_tmp16_), _tmp17_)) {
							ValaDataType* _tmp18_;
							ValaCCodeExpression* _tmp19_;
							ValaCCodeFunctionCall* _tmp20_;
							ValaCCodeFunctionCall* ref_call;
							ValaCCodeExpression* _tmp21_;
							ValaDataType* _tmp22_;
							ValaCCodeExpression* _tmp23_;
							ref_call = (_tmp20_ = vala_ccode_function_call_new (_tmp19_ = vala_ccode_base_module_get_dup_func_expression ((ValaCCodeBaseModule*) self, _tmp18_ = vala_ccode_base_module_get_this_type ((ValaCCodeBaseModule*) self), vala_code_node_get_source_reference ((ValaCodeNode*) delegate_expr), FALSE)), _vala_ccode_node_unref0 (_tmp19_), _vala_code_node_unref0 (_tmp18_), _tmp20_);
							vala_ccode_function_call_add_argument (ref_call, delegate_target);
							delegate_target = (_tmp21_ = _vala_ccode_node_ref0 ((ValaCCodeExpression*) ref_call), _vala_ccode_node_unref0 (delegate_target), _tmp21_);
							*delegate_target_destroy_notify = (_tmp23_ = vala_ccode_base_module_get_destroy_func_expression ((ValaCCodeBaseModule*) self, _tmp22_ = vala_ccode_base_module_get_this_type ((ValaCCodeBaseModule*) self), FALSE), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp23_);
							_vala_code_node_unref0 (_tmp22_);
							_vala_ccode_node_unref0 (ref_call);
						} else {
							ValaCCodeIdentifier* _tmp24_;
							ValaCCodeFunctionCall* _tmp25_;
							ValaCCodeFunctionCall* ref_call;
							ValaCCodeExpression* _tmp26_;
							ValaCCodeExpression* _tmp27_;
							ref_call = (_tmp25_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp24_ = vala_ccode_identifier_new ("g_object_ref"))), _vala_ccode_node_unref0 (_tmp24_), _tmp25_);
							vala_ccode_function_call_add_argument (ref_call, delegate_target);
							delegate_target = (_tmp26_ = _vala_ccode_node_ref0 ((ValaCCodeExpression*) ref_call), _vala_ccode_node_unref0 (delegate_target), _tmp26_);
							*delegate_target_destroy_notify = (_tmp27_ = (ValaCCodeExpression*) vala_ccode_identifier_new ("g_object_unref"), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp27_);
							_vala_ccode_node_unref0 (ref_call);
						}
					}
					result = delegate_target;
					_vala_code_node_unref0 (delegate_type);
					_vala_code_node_unref0 (lambda);
					return result;
				} else {
					result = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL");
					_vala_code_node_unref0 (delegate_type);
					_vala_code_node_unref0 (lambda);
					return result;
				}
			}
			_vala_code_node_unref0 (delegate_type);
			_vala_code_node_unref0 (lambda);
		} else {
			if (vala_expression_get_symbol_reference (delegate_expr) != NULL) {
				if (VALA_IS_FORMAL_PARAMETER (vala_expression_get_symbol_reference (delegate_expr))) {
					ValaFormalParameter* param;
					param = _vala_code_node_ref0 (VALA_FORMAL_PARAMETER (vala_expression_get_symbol_reference (delegate_expr)));
					if (vala_formal_parameter_get_captured (param)) {
						ValaBlock* block;
						char* _tmp28_;
						ValaCCodeExpression* _tmp29_;
						char* _tmp30_;
						char* _tmp31_;
						ValaCCodeExpression* _tmp32_;
						char* _tmp33_;
						ValaCCodeExpression* _tmp34_;
						char* _tmp35_;
						char* _tmp36_;
						ValaCCodeExpression* _tmp37_;
						block = _vala_code_node_ref0 (vala_method_get_body (VALA_METHOD (vala_symbol_get_parent_symbol ((ValaSymbol*) param))));
						*delegate_target_destroy_notify = (_tmp32_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (_tmp29_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, _tmp28_ = g_strdup_printf ("_data%d_", vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, block))), _tmp31_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp30_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)))), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp32_);
						_g_free0 (_tmp31_);
						_g_free0 (_tmp30_);
						_vala_ccode_node_unref0 (_tmp29_);
						_g_free0 (_tmp28_);
						result = (_tmp37_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (_tmp34_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, _tmp33_ = g_strdup_printf ("_data%d_", vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, block))), _tmp36_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp35_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)))), _g_free0 (_tmp36_), _g_free0 (_tmp35_), _vala_ccode_node_unref0 (_tmp34_), _g_free0 (_tmp33_), _tmp37_);
						_vala_code_node_unref0 (block);
						_vala_code_node_unref0 (param);
						return result;
						_vala_code_node_unref0 (block);
					} else {
						gboolean _tmp38_ = FALSE;
						if (vala_ccode_base_module_get_current_method ((ValaCCodeBaseModule*) self) != NULL) {
							_tmp38_ = vala_method_get_coroutine (vala_ccode_base_module_get_current_method ((ValaCCodeBaseModule*) self));
						} else {
							_tmp38_ = FALSE;
						}
						if (_tmp38_) {
							ValaCCodeIdentifier* _tmp39_;
							char* _tmp40_;
							char* _tmp41_;
							ValaCCodeExpression* _tmp42_;
							ValaCCodeIdentifier* _tmp43_;
							char* _tmp44_;
							char* _tmp45_;
							ValaCCodeExpression* _tmp46_;
							*delegate_target_destroy_notify = (_tmp42_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp39_ = vala_ccode_identifier_new ("data")), _tmp41_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp40_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)))), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp42_);
							_g_free0 (_tmp41_);
							_g_free0 (_tmp40_);
							_vala_ccode_node_unref0 (_tmp39_);
							result = (_tmp46_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp43_ = vala_ccode_identifier_new ("data")), _tmp45_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp44_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)))), _g_free0 (_tmp45_), _g_free0 (_tmp44_), _vala_ccode_node_unref0 (_tmp43_), _tmp46_);
							_vala_code_node_unref0 (param);
							return result;
						} else {
							char* _tmp47_;
							char* _tmp48_;
							ValaCCodeExpression* _tmp49_;
							ValaCCodeExpression* target_expr;
							target_expr = (_tmp49_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp48_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp47_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)))), _g_free0 (_tmp48_), _g_free0 (_tmp47_), _tmp49_);
							if (expr_owned) {
								char* _tmp50_;
								char* _tmp51_;
								ValaCCodeExpression* _tmp52_;
								*delegate_target_destroy_notify = (_tmp52_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp51_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp50_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)))), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp52_);
								_g_free0 (_tmp51_);
								_g_free0 (_tmp50_);
							}
							if (vala_formal_parameter_get_direction (param) != VALA_PARAMETER_DIRECTION_IN) {
								ValaCCodeExpression* _tmp53_;
								target_expr = (_tmp53_ = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_POINTER_INDIRECTION, target_expr), _vala_ccode_node_unref0 (target_expr), _tmp53_);
								if (expr_owned) {
									ValaCCodeExpression* _tmp54_;
									*delegate_target_destroy_notify = (_tmp54_ = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_POINTER_INDIRECTION, *delegate_target_destroy_notify), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp54_);
								}
							}
							if (is_out) {
								if (expr_owned) {
									ValaCCodeExpression* _tmp55_;
									*delegate_target_destroy_notify = (_tmp55_ = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_ADDRESS_OF, *delegate_target_destroy_notify), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp55_);
								}
								result = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_ADDRESS_OF, target_expr);
								_vala_ccode_node_unref0 (target_expr);
								_vala_code_node_unref0 (param);
								return result;
							} else {
								result = target_expr;
								_vala_code_node_unref0 (param);
								return result;
							}
							_vala_ccode_node_unref0 (target_expr);
						}
					}
					_vala_code_node_unref0 (param);
				} else {
					if (VALA_IS_LOCAL_VARIABLE (vala_expression_get_symbol_reference (delegate_expr))) {
						ValaLocalVariable* local;
						local = _vala_code_node_ref0 (VALA_LOCAL_VARIABLE (vala_expression_get_symbol_reference (delegate_expr)));
						if (vala_local_variable_get_captured (local)) {
							ValaBlock* block;
							char* _tmp56_;
							ValaCCodeExpression* _tmp57_;
							char* _tmp58_;
							char* _tmp59_;
							ValaCCodeExpression* _tmp60_;
							char* _tmp61_;
							ValaCCodeExpression* _tmp62_;
							char* _tmp63_;
							char* _tmp64_;
							ValaCCodeExpression* _tmp65_;
							block = _vala_code_node_ref0 (VALA_BLOCK (vala_symbol_get_parent_symbol ((ValaSymbol*) local)));
							*delegate_target_destroy_notify = (_tmp60_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (_tmp57_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, _tmp56_ = g_strdup_printf ("_data%d_", vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, block))), _tmp59_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp58_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) local)))), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp60_);
							_g_free0 (_tmp59_);
							_g_free0 (_tmp58_);
							_vala_ccode_node_unref0 (_tmp57_);
							_g_free0 (_tmp56_);
							result = (_tmp65_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (_tmp62_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, _tmp61_ = g_strdup_printf ("_data%d_", vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, block))), _tmp64_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp63_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) local)))), _g_free0 (_tmp64_), _g_free0 (_tmp63_), _vala_ccode_node_unref0 (_tmp62_), _g_free0 (_tmp61_), _tmp65_);
							_vala_code_node_unref0 (block);
							_vala_code_node_unref0 (local);
							return result;
							_vala_code_node_unref0 (block);
						} else {
							gboolean _tmp66_ = FALSE;
							if (vala_ccode_base_module_get_current_method ((ValaCCodeBaseModule*) self) != NULL) {
								_tmp66_ = vala_method_get_coroutine (vala_ccode_base_module_get_current_method ((ValaCCodeBaseModule*) self));
							} else {
								_tmp66_ = FALSE;
							}
							if (_tmp66_) {
								ValaCCodeIdentifier* _tmp67_;
								char* _tmp68_;
								char* _tmp69_;
								ValaCCodeExpression* _tmp70_;
								ValaCCodeIdentifier* _tmp71_;
								char* _tmp72_;
								char* _tmp73_;
								ValaCCodeExpression* _tmp74_;
								*delegate_target_destroy_notify = (_tmp70_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp67_ = vala_ccode_identifier_new ("data")), _tmp69_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp68_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) local)))), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp70_);
								_g_free0 (_tmp69_);
								_g_free0 (_tmp68_);
								_vala_ccode_node_unref0 (_tmp67_);
								result = (_tmp74_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp71_ = vala_ccode_identifier_new ("data")), _tmp73_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp72_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) local)))), _g_free0 (_tmp73_), _g_free0 (_tmp72_), _vala_ccode_node_unref0 (_tmp71_), _tmp74_);
								_vala_code_node_unref0 (local);
								return result;
							} else {
								char* _tmp75_;
								char* _tmp76_;
								ValaCCodeIdentifier* _tmp77_;
								ValaCCodeIdentifier* target_expr;
								target_expr = (_tmp77_ = vala_ccode_identifier_new (_tmp76_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp75_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) local)))), _g_free0 (_tmp76_), _g_free0 (_tmp75_), _tmp77_);
								if (expr_owned) {
									char* _tmp78_;
									char* _tmp79_;
									ValaCCodeExpression* _tmp80_;
									*delegate_target_destroy_notify = (_tmp80_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp79_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp78_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) local)))), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp80_);
									_g_free0 (_tmp79_);
									_g_free0 (_tmp78_);
								}
								if (is_out) {
									if (expr_owned) {
										ValaCCodeExpression* _tmp81_;
										*delegate_target_destroy_notify = (_tmp81_ = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_ADDRESS_OF, *delegate_target_destroy_notify), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp81_);
									}
									result = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_ADDRESS_OF, (ValaCCodeExpression*) target_expr);
									_vala_ccode_node_unref0 (target_expr);
									_vala_code_node_unref0 (local);
									return result;
								} else {
									result = (ValaCCodeExpression*) target_expr;
									_vala_code_node_unref0 (local);
									return result;
								}
								_vala_ccode_node_unref0 (target_expr);
							}
						}
						_vala_code_node_unref0 (local);
					} else {
						if (VALA_IS_FIELD (vala_expression_get_symbol_reference (delegate_expr))) {
							ValaField* field;
							char* _tmp82_;
							char* _tmp83_;
							char* target_cname;
							char* _tmp84_;
							char* _tmp85_;
							char* target_destroy_notify_cname;
							ValaMemberAccess* ma;
							ValaCCodeExpression* target_expr;
							field = _vala_code_node_ref0 (VALA_FIELD (vala_expression_get_symbol_reference (delegate_expr)));
							target_cname = (_tmp83_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp82_ = vala_field_get_cname (field)), _g_free0 (_tmp82_), _tmp83_);
							target_destroy_notify_cname = (_tmp85_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp84_ = vala_field_get_cname (field)), _g_free0 (_tmp84_), _tmp85_);
							ma = _vala_code_node_ref0 (VALA_MEMBER_ACCESS (delegate_expr));
							target_expr = NULL;
							if (vala_field_get_no_delegate_target (field)) {
								result = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL");
								_vala_ccode_node_unref0 (target_expr);
								_vala_code_node_unref0 (ma);
								_g_free0 (target_destroy_notify_cname);
								_g_free0 (target_cname);
								_vala_code_node_unref0 (field);
								return result;
							}
							if (vala_field_get_binding (field) == MEMBER_BINDING_INSTANCE) {
								ValaDataType* instance_expression_type;
								ValaDataType* instance_target_type;
								ValaCCodeExpression* pub_inst;
								ValaCCodeExpression* typed_inst;
								ValaCCodeExpression* inst;
								instance_expression_type = _vala_code_node_ref0 (vala_expression_get_value_type (vala_member_access_get_inner (ma)));
								instance_target_type = vala_ccode_base_module_get_data_type_for_symbol (VALA_TYPESYMBOL (vala_symbol_get_parent_symbol ((ValaSymbol*) field)));
								pub_inst = VALA_CCODE_EXPRESSION (vala_ccode_base_module_get_ccodenode ((ValaCCodeBaseModule*) self, (ValaCodeNode*) vala_member_access_get_inner (ma)));
								typed_inst = vala_ccode_base_module_transform_expression ((ValaCCodeBaseModule*) self, pub_inst, instance_expression_type, instance_target_type, NULL);
								inst = NULL;
								if (vala_symbol_get_access ((ValaSymbol*) field) == VALA_SYMBOL_ACCESSIBILITY_PRIVATE) {
									ValaCCodeExpression* _tmp86_;
									inst = (_tmp86_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (typed_inst, "priv"), _vala_ccode_node_unref0 (inst), _tmp86_);
								} else {
									ValaCCodeExpression* _tmp87_;
									inst = (_tmp87_ = _vala_ccode_node_ref0 (typed_inst), _vala_ccode_node_unref0 (inst), _tmp87_);
								}
								if (vala_typesymbol_is_reference_type (VALA_TYPESYMBOL (vala_symbol_get_parent_symbol ((ValaSymbol*) field)))) {
									ValaCCodeExpression* _tmp88_;
									target_expr = (_tmp88_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (inst, target_cname), _vala_ccode_node_unref0 (target_expr), _tmp88_);
									if (expr_owned) {
										ValaCCodeExpression* _tmp89_;
										*delegate_target_destroy_notify = (_tmp89_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (inst, target_destroy_notify_cname), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp89_);
									}
								} else {
									ValaCCodeExpression* _tmp90_;
									target_expr = (_tmp90_ = (ValaCCodeExpression*) vala_ccode_member_access_new (inst, target_cname, FALSE), _vala_ccode_node_unref0 (target_expr), _tmp90_);
									if (expr_owned) {
										ValaCCodeExpression* _tmp91_;
										*delegate_target_destroy_notify = (_tmp91_ = (ValaCCodeExpression*) vala_ccode_member_access_new (inst, target_destroy_notify_cname, FALSE), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp91_);
									}
								}
								_vala_ccode_node_unref0 (inst);
								_vala_ccode_node_unref0 (typed_inst);
								_vala_ccode_node_unref0 (pub_inst);
								_vala_code_node_unref0 (instance_target_type);
								_vala_code_node_unref0 (instance_expression_type);
							} else {
								ValaCCodeExpression* _tmp92_;
								target_expr = (_tmp92_ = (ValaCCodeExpression*) vala_ccode_identifier_new (target_cname), _vala_ccode_node_unref0 (target_expr), _tmp92_);
								if (expr_owned) {
									ValaCCodeExpression* _tmp93_;
									*delegate_target_destroy_notify = (_tmp93_ = (ValaCCodeExpression*) vala_ccode_identifier_new (target_destroy_notify_cname), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp93_);
								}
							}
							if (is_out) {
								result = (ValaCCodeExpression*) vala_ccode_unary_expression_new (VALA_CCODE_UNARY_OPERATOR_ADDRESS_OF, target_expr);
								_vala_ccode_node_unref0 (target_expr);
								_vala_code_node_unref0 (ma);
								_g_free0 (target_destroy_notify_cname);
								_g_free0 (target_cname);
								_vala_code_node_unref0 (field);
								return result;
							} else {
								result = target_expr;
								_vala_code_node_unref0 (ma);
								_g_free0 (target_destroy_notify_cname);
								_g_free0 (target_cname);
								_vala_code_node_unref0 (field);
								return result;
							}
							_vala_ccode_node_unref0 (target_expr);
							_vala_code_node_unref0 (ma);
							_g_free0 (target_destroy_notify_cname);
							_g_free0 (target_cname);
							_vala_code_node_unref0 (field);
						} else {
							if (VALA_IS_METHOD (vala_expression_get_symbol_reference (delegate_expr))) {
								ValaMethod* m;
								ValaMemberAccess* ma;
								m = _vala_code_node_ref0 (VALA_METHOD (vala_expression_get_symbol_reference (delegate_expr)));
								ma = _vala_code_node_ref0 (VALA_MEMBER_ACCESS (delegate_expr));
								if (vala_method_get_binding (m) == MEMBER_BINDING_STATIC) {
									result = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL");
									_vala_code_node_unref0 (ma);
									_vala_code_node_unref0 (m);
									return result;
								} else {
									if (vala_method_get_is_async_callback (m)) {
										if (vala_method_get_closure (vala_ccode_base_module_get_current_method ((ValaCCodeBaseModule*) self))) {
											ValaBlock* block;
											char* _tmp94_;
											ValaCCodeExpression* _tmp95_;
											ValaCCodeExpression* _tmp96_;
											block = _vala_code_node_ref0 (vala_method_get_body (VALA_METHOD (vala_symbol_get_parent_symbol ((ValaSymbol*) m))));
											result = (_tmp96_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer (_tmp95_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, _tmp94_ = g_strdup_printf ("_data%d_", vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, block))), "_async_data_"), _vala_ccode_node_unref0 (_tmp95_), _g_free0 (_tmp94_), _tmp96_);
											_vala_code_node_unref0 (block);
											_vala_code_node_unref0 (ma);
											_vala_code_node_unref0 (m);
											return result;
											_vala_code_node_unref0 (block);
										} else {
											result = (ValaCCodeExpression*) vala_ccode_identifier_new ("data");
											_vala_code_node_unref0 (ma);
											_vala_code_node_unref0 (m);
											return result;
										}
									} else {
										ValaCCodeExpression* delegate_target;
										ValaDataType* _tmp97_;
										ValaDelegateType* delegate_type;
										gboolean _tmp98_ = FALSE;
										gboolean _tmp99_ = FALSE;
										gboolean _tmp100_ = FALSE;
										delegate_target = VALA_CCODE_EXPRESSION (vala_ccode_base_module_get_ccodenode ((ValaCCodeBaseModule*) self, (ValaCodeNode*) vala_member_access_get_inner (ma)));
										delegate_type = _vala_code_node_ref0 ((_tmp97_ = vala_expression_get_target_type (delegate_expr), VALA_IS_DELEGATE_TYPE (_tmp97_) ? ((ValaDelegateType*) _tmp97_) : NULL));
										if (expr_owned) {
											_tmp100_ = TRUE;
										} else {
											gboolean _tmp101_ = FALSE;
											if (delegate_type != NULL) {
												_tmp101_ = vala_delegate_type_get_is_called_once (delegate_type);
											} else {
												_tmp101_ = FALSE;
											}
											_tmp100_ = _tmp101_;
										}
										if (_tmp100_) {
											_tmp99_ = vala_data_type_get_data_type (vala_expression_get_value_type (vala_member_access_get_inner (ma))) != NULL;
										} else {
											_tmp99_ = FALSE;
										}
										if (_tmp99_) {
											_tmp98_ = vala_typesymbol_is_reference_counting (vala_data_type_get_data_type (vala_expression_get_value_type (vala_member_access_get_inner (ma))));
										} else {
											_tmp98_ = FALSE;
										}
										if (_tmp98_) {
											ValaCCodeExpression* _tmp102_;
											ValaCCodeFunctionCall* _tmp103_;
											ValaCCodeFunctionCall* ref_call;
											ValaCCodeExpression* _tmp104_;
											ValaCCodeExpression* _tmp105_;
											ref_call = (_tmp103_ = vala_ccode_function_call_new (_tmp102_ = vala_ccode_base_module_get_dup_func_expression ((ValaCCodeBaseModule*) self, vala_expression_get_value_type (vala_member_access_get_inner (ma)), vala_code_node_get_source_reference ((ValaCodeNode*) delegate_expr), FALSE)), _vala_ccode_node_unref0 (_tmp102_), _tmp103_);
											vala_ccode_function_call_add_argument (ref_call, delegate_target);
											delegate_target = (_tmp104_ = _vala_ccode_node_ref0 ((ValaCCodeExpression*) ref_call), _vala_ccode_node_unref0 (delegate_target), _tmp104_);
											*delegate_target_destroy_notify = (_tmp105_ = vala_ccode_base_module_get_destroy_func_expression ((ValaCCodeBaseModule*) self, vala_expression_get_value_type (vala_member_access_get_inner (ma)), FALSE), _vala_ccode_node_unref0 (*delegate_target_destroy_notify), _tmp105_);
											_vala_ccode_node_unref0 (ref_call);
										}
										result = delegate_target;
										_vala_code_node_unref0 (delegate_type);
										_vala_code_node_unref0 (ma);
										_vala_code_node_unref0 (m);
										return result;
									}
								}
								_vala_code_node_unref0 (ma);
								_vala_code_node_unref0 (m);
							} else {
								if (VALA_IS_PROPERTY (vala_expression_get_symbol_reference (delegate_expr))) {
									result = _vala_ccode_node_ref0 (vala_expression_get_delegate_target (delegate_expr));
									return result;
								}
							}
						}
					}
				}
			}
		}
	}
	result = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL");
	return result;
}


static char* vala_ccode_delegate_module_real_get_delegate_target_destroy_notify_cname (ValaCCodeBaseModule* base, const char* delegate_cname) {
	ValaCCodeDelegateModule * self;
	char* result = NULL;
	self = (ValaCCodeDelegateModule*) base;
	g_return_val_if_fail (delegate_cname != NULL, NULL);
	result = g_strdup_printf ("%s_target_destroy_notify", delegate_cname);
	return result;
}


static ValaCCodeExpression* vala_ccode_delegate_module_real_get_implicit_cast_expression (ValaCCodeBaseModule* base, ValaCCodeExpression* source_cexpr, ValaDataType* expression_type, ValaDataType* target_type, ValaExpression* expr) {
	ValaCCodeDelegateModule * self;
	ValaCCodeExpression* result = NULL;
	gboolean _tmp0_ = FALSE;
	self = (ValaCCodeDelegateModule*) base;
	g_return_val_if_fail (source_cexpr != NULL, NULL);
	if (VALA_IS_DELEGATE_TYPE (target_type)) {
		_tmp0_ = VALA_IS_METHOD_TYPE (expression_type);
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		ValaDelegateType* dt;
		ValaMethodType* mt;
		ValaMethod* method;
		char* _tmp3_;
		ValaCCodeExpression* _tmp4_;
		dt = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (target_type));
		mt = _vala_code_node_ref0 (VALA_METHOD_TYPE (expression_type));
		method = _vala_code_node_ref0 (vala_method_type_get_method_symbol (mt));
		if (vala_method_get_base_method (method) != NULL) {
			ValaMethod* _tmp1_;
			method = (_tmp1_ = _vala_code_node_ref0 (vala_method_get_base_method (method)), _vala_code_node_unref0 (method), _tmp1_);
		} else {
			if (vala_method_get_base_interface_method (method) != NULL) {
				ValaMethod* _tmp2_;
				method = (_tmp2_ = _vala_code_node_ref0 (vala_method_get_base_interface_method (method)), _vala_code_node_unref0 (method), _tmp2_);
			}
		}
		result = (_tmp4_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp3_ = vala_ccode_delegate_module_generate_delegate_wrapper (self, method, dt, expr)), _g_free0 (_tmp3_), _tmp4_);
		_vala_code_node_unref0 (method);
		_vala_code_node_unref0 (mt);
		_vala_code_node_unref0 (dt);
		return result;
		_vala_code_node_unref0 (method);
		_vala_code_node_unref0 (mt);
		_vala_code_node_unref0 (dt);
	}
	result = VALA_CCODE_BASE_MODULE_CLASS (vala_ccode_delegate_module_parent_class)->get_implicit_cast_expression ((ValaCCodeBaseModule*) VALA_CCODE_ARRAY_MODULE (self), source_cexpr, expression_type, target_type, expr);
	return result;
}


static char* vala_ccode_delegate_module_generate_delegate_wrapper (ValaCCodeDelegateModule* self, ValaMethod* m, ValaDelegateType* dt, ValaExpression* expr) {
	char* result = NULL;
	ValaDelegate* d;
	char* delegate_name;
	ValaSymbol* _tmp0_;
	ValaSignal* sig;
	ValaSignal* _tmp1_;
	ValaDynamicSignal* dynamic_sig;
	char* _tmp8_;
	char* _tmp9_;
	char* wrapper_name;
	char* return_type_cname;
	ValaCCodeFunction* function;
	ValaHashMap* cparam_map;
	ValaList* d_params;
	gboolean _tmp13_ = FALSE;
	ValaList* _tmp22_;
	gboolean _tmp23_;
	gint last_pos;
	gint min_pos = 0;
	ValaHashMap* carg_map;
	gint i;
	gboolean _tmp29_ = FALSE;
	gboolean first;
	gboolean _tmp64_ = FALSE;
	ValaList* _tmp72_;
	gboolean _tmp73_;
	char* _tmp75_;
	ValaCCodeIdentifier* _tmp76_;
	ValaCCodeFunctionCall* _tmp77_;
	ValaCCodeFunctionCall* ccall;
	ValaCCodeBlock* block;
	gboolean _tmp83_ = FALSE;
	gboolean _tmp86_ = FALSE;
	gboolean _tmp87_ = FALSE;
	gboolean _tmp88_ = FALSE;
	gboolean _tmp102_ = FALSE;
	ValaCCodeFunction* _tmp105_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (m != NULL, NULL);
	g_return_val_if_fail (dt != NULL, NULL);
	d = _vala_code_node_ref0 (vala_delegate_type_get_delegate_symbol (dt));
	delegate_name = NULL;
	sig = _vala_code_node_ref0 ((_tmp0_ = vala_symbol_get_parent_symbol ((ValaSymbol*) d), VALA_IS_SIGNAL (_tmp0_) ? ((ValaSignal*) _tmp0_) : NULL));
	dynamic_sig = _vala_code_node_ref0 ((_tmp1_ = sig, VALA_IS_DYNAMIC_SIGNAL (_tmp1_) ? ((ValaDynamicSignal*) _tmp1_) : NULL));
	if (dynamic_sig != NULL) {
		char* _tmp2_;
		delegate_name = (_tmp2_ = vala_ccode_base_module_get_dynamic_signal_cname ((ValaCCodeBaseModule*) self, dynamic_sig), _g_free0 (delegate_name), _tmp2_);
	} else {
		if (sig != NULL) {
			char* _tmp3_;
			char* _tmp4_;
			char* _tmp5_;
			delegate_name = (_tmp5_ = g_strconcat (_tmp3_ = vala_symbol_get_lower_case_cprefix (vala_symbol_get_parent_symbol ((ValaSymbol*) sig)), _tmp4_ = vala_signal_get_cname (sig), NULL), _g_free0 (delegate_name), _tmp5_);
			_g_free0 (_tmp4_);
			_g_free0 (_tmp3_);
		} else {
			char* _tmp6_;
			char* _tmp7_;
			delegate_name = (_tmp7_ = vala_symbol_camel_case_to_lower_case (_tmp6_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) d, FALSE)), _g_free0 (delegate_name), _tmp7_);
			_g_free0 (_tmp6_);
		}
	}
	wrapper_name = (_tmp9_ = g_strdup_printf ("_%s_%s", _tmp8_ = vala_method_get_cname (m), delegate_name), _g_free0 (_tmp8_), _tmp9_);
	if (!vala_ccode_base_module_add_wrapper ((ValaCCodeBaseModule*) self, wrapper_name)) {
		result = wrapper_name;
		_vala_code_node_unref0 (dynamic_sig);
		_vala_code_node_unref0 (sig);
		_g_free0 (delegate_name);
		_vala_code_node_unref0 (d);
		return result;
	}
	return_type_cname = vala_data_type_get_cname (vala_delegate_get_return_type (d));
	if (vala_data_type_is_real_non_null_struct_type (vala_delegate_get_return_type (d))) {
		char* _tmp10_;
		return_type_cname = (_tmp10_ = g_strdup ("void"), _g_free0 (return_type_cname), _tmp10_);
	}
	function = vala_ccode_function_new (wrapper_name, return_type_cname);
	vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	vala_code_node_set_ccodenode ((ValaCodeNode*) m, (ValaCCodeNode*) function);
	cparam_map = vala_hash_map_new (G_TYPE_INT, NULL, NULL, VALA_TYPE_CCODE_FORMAL_PARAMETER, (GBoxedCopyFunc) vala_ccode_node_ref, vala_ccode_node_unref, g_direct_hash, g_direct_equal, g_direct_equal);
	if (vala_delegate_get_has_target (d)) {
		ValaCCodeFormalParameter* cparam;
		cparam = vala_ccode_formal_parameter_new ("self", "gpointer");
		vala_map_set ((ValaMap*) cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_delegate_get_cinstance_parameter_position (d), FALSE)), cparam);
		_vala_ccode_node_unref0 (cparam);
	}
	if (vala_delegate_get_sender_type (d) != NULL) {
		ValaFormalParameter* param;
		param = vala_formal_parameter_new ("_sender", vala_delegate_get_sender_type (d), NULL);
		vala_ccode_method_module_generate_parameter ((ValaCCodeMethodModule*) self, param, ((ValaCCodeBaseModule*) self)->source_declarations, (ValaMap*) cparam_map, NULL);
		_vala_code_node_unref0 (param);
	}
	d_params = vala_delegate_get_parameters (d);
	{
		ValaIterator* _param_it;
		_param_it = vala_iterable_iterator ((ValaIterable*) d_params);
		while (TRUE) {
			ValaFormalParameter* param;
			gboolean _tmp11_ = FALSE;
			gboolean _tmp12_ = FALSE;
			if (!vala_iterator_next (_param_it)) {
				break;
			}
			param = (ValaFormalParameter*) vala_iterator_get (_param_it);
			if (dynamic_sig != NULL) {
				_tmp12_ = VALA_IS_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) param));
			} else {
				_tmp12_ = FALSE;
			}
			if (_tmp12_) {
				_tmp11_ = vala_data_type_get_data_type (vala_array_type_get_element_type (VALA_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) param)))) == vala_data_type_get_data_type (((ValaCCodeBaseModule*) self)->string_type);
			} else {
				_tmp11_ = FALSE;
			}
			if (_tmp11_) {
				vala_formal_parameter_set_no_array_length (param, TRUE);
				vala_formal_parameter_set_array_null_terminated (param, TRUE);
			}
			vala_ccode_method_module_generate_parameter ((ValaCCodeMethodModule*) self, param, ((ValaCCodeBaseModule*) self)->source_declarations, (ValaMap*) cparam_map, NULL);
			_vala_code_node_unref0 (param);
		}
		_vala_collection_object_unref0 (_param_it);
	}
	if (!vala_delegate_get_no_array_length (d)) {
		_tmp13_ = VALA_IS_ARRAY_TYPE (vala_delegate_get_return_type (d));
	} else {
		_tmp13_ = FALSE;
	}
	if (_tmp13_) {
		ValaArrayType* array_type;
		array_type = _vala_code_node_ref0 (VALA_ARRAY_TYPE (vala_delegate_get_return_type (d)));
		{
			gint dim;
			dim = 1;
			{
				gboolean _tmp14_;
				_tmp14_ = TRUE;
				while (TRUE) {
					char* _tmp15_;
					ValaCCodeFormalParameter* _tmp16_;
					ValaCCodeFormalParameter* cparam;
					if (!_tmp14_) {
						dim++;
					}
					_tmp14_ = FALSE;
					if (!(dim <= vala_array_type_get_rank (array_type))) {
						break;
					}
					cparam = (_tmp16_ = vala_ccode_formal_parameter_new (_tmp15_ = vala_ccode_base_module_get_array_length_cname ((ValaCCodeBaseModule*) self, "result", dim), "int*"), _g_free0 (_tmp15_), _tmp16_);
					vala_map_set ((ValaMap*) cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_delegate_get_carray_length_parameter_position (d) + (0.01 * dim), FALSE)), cparam);
					_vala_ccode_node_unref0 (cparam);
				}
			}
		}
		_vala_code_node_unref0 (array_type);
	} else {
		if (VALA_IS_DELEGATE_TYPE (vala_delegate_get_return_type (d))) {
			ValaDelegateType* deleg_type;
			deleg_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_delegate_get_return_type (d)));
			if (vala_delegate_get_has_target (vala_delegate_type_get_delegate_symbol (deleg_type))) {
				char* _tmp17_;
				ValaCCodeFormalParameter* _tmp18_;
				ValaCCodeFormalParameter* cparam;
				cparam = (_tmp18_ = vala_ccode_formal_parameter_new (_tmp17_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, "result"), "void**"), _g_free0 (_tmp17_), _tmp18_);
				vala_map_set ((ValaMap*) cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_delegate_get_cdelegate_target_parameter_position (d), FALSE)), cparam);
				_vala_ccode_node_unref0 (cparam);
			}
			_vala_code_node_unref0 (deleg_type);
		} else {
			if (vala_data_type_is_real_non_null_struct_type (vala_delegate_get_return_type (d))) {
				char* _tmp19_;
				char* _tmp20_;
				ValaCCodeFormalParameter* _tmp21_;
				ValaCCodeFormalParameter* cparam;
				cparam = (_tmp21_ = vala_ccode_formal_parameter_new ("result", _tmp20_ = g_strdup_printf ("%s*", _tmp19_ = vala_data_type_get_cname (vala_delegate_get_return_type (d)))), _g_free0 (_tmp20_), _g_free0 (_tmp19_), _tmp21_);
				vala_map_set ((ValaMap*) cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, (double) (-3), FALSE)), cparam);
				_vala_ccode_node_unref0 (cparam);
			}
		}
	}
	if ((_tmp23_ = vala_collection_get_size ((ValaCollection*) (_tmp22_ = vala_code_node_get_error_types ((ValaCodeNode*) m))) > 0, _vala_collection_object_unref0 (_tmp22_), _tmp23_)) {
		ValaCCodeFormalParameter* cparam;
		cparam = vala_ccode_formal_parameter_new ("error", "GError**");
		vala_map_set ((ValaMap*) cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, (double) (-1), FALSE)), cparam);
		_vala_ccode_node_unref0 (cparam);
	}
	last_pos = -1;
	while (TRUE) {
		ValaCCodeFormalParameter* _tmp28_;
		min_pos = -1;
		{
			ValaSet* _tmp24_;
			ValaIterator* _tmp25_;
			ValaIterator* _pos_it;
			_pos_it = (_tmp25_ = vala_iterable_iterator ((ValaIterable*) (_tmp24_ = vala_map_get_keys ((ValaMap*) cparam_map))), _vala_collection_object_unref0 (_tmp24_), _tmp25_);
			while (TRUE) {
				gint pos;
				gboolean _tmp26_ = FALSE;
				if (!vala_iterator_next (_pos_it)) {
					break;
				}
				pos = GPOINTER_TO_INT (vala_iterator_get (_pos_it));
				if (pos > last_pos) {
					gboolean _tmp27_ = FALSE;
					if (min_pos == (-1)) {
						_tmp27_ = TRUE;
					} else {
						_tmp27_ = pos < min_pos;
					}
					_tmp26_ = _tmp27_;
				} else {
					_tmp26_ = FALSE;
				}
				if (_tmp26_) {
					min_pos = pos;
				}
			}
			_vala_collection_object_unref0 (_pos_it);
		}
		if (min_pos == (-1)) {
			break;
		}
		vala_ccode_function_add_parameter (function, _tmp28_ = (ValaCCodeFormalParameter*) vala_map_get ((ValaMap*) cparam_map, GINT_TO_POINTER (min_pos)));
		_vala_ccode_node_unref0 (_tmp28_);
		last_pos = min_pos;
	}
	carg_map = vala_hash_map_new (G_TYPE_INT, NULL, NULL, VALA_TYPE_CCODE_EXPRESSION, (GBoxedCopyFunc) vala_ccode_node_ref, vala_ccode_node_unref, g_direct_hash, g_direct_equal, g_direct_equal);
	i = 0;
	if (vala_method_get_binding (m) == MEMBER_BINDING_INSTANCE) {
		_tmp29_ = TRUE;
	} else {
		_tmp29_ = vala_method_get_closure (m);
	}
	if (_tmp29_) {
		ValaCCodeExpression* arg;
		arg = NULL;
		if (vala_delegate_get_has_target (d)) {
			ValaCCodeExpression* _tmp30_;
			arg = (_tmp30_ = (ValaCCodeExpression*) vala_ccode_identifier_new ("self"), _vala_ccode_node_unref0 (arg), _tmp30_);
		} else {
			if (vala_collection_get_size ((ValaCollection*) d_params) == 0) {
				ValaSourceReference* _tmp31_;
				ValaCCodeExpression* _tmp32_;
				_tmp31_ = NULL;
				if (expr != NULL) {
					_tmp31_ = vala_code_node_get_source_reference ((ValaCodeNode*) expr);
				} else {
					_tmp31_ = NULL;
				}
				vala_report_error (_tmp31_, "Cannot create delegate without target for instance method or closure");
				arg = (_tmp32_ = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL"), _vala_ccode_node_unref0 (arg), _tmp32_);
			} else {
				ValaFormalParameter* _tmp33_;
				ValaCCodeNode* _tmp34_;
				ValaCCodeExpression* _tmp35_;
				arg = (_tmp35_ = (ValaCCodeExpression*) vala_ccode_identifier_new (vala_ccode_formal_parameter_get_name ((_tmp34_ = vala_code_node_get_ccodenode ((ValaCodeNode*) (_tmp33_ = (ValaFormalParameter*) vala_list_get (d_params, 0))), VALA_IS_CCODE_FORMAL_PARAMETER (_tmp34_) ? ((ValaCCodeFormalParameter*) _tmp34_) : NULL))), _vala_ccode_node_unref0 (arg), _tmp35_);
				_vala_code_node_unref0 (_tmp33_);
				i = 1;
			}
		}
		vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_method_get_cinstance_parameter_position (m), FALSE)), arg);
		_vala_ccode_node_unref0 (arg);
	}
	first = TRUE;
	{
		ValaList* _tmp36_;
		ValaIterator* _tmp37_;
		ValaIterator* _param_it;
		_param_it = (_tmp37_ = vala_iterable_iterator ((ValaIterable*) (_tmp36_ = vala_method_get_parameters (m))), _vala_collection_object_unref0 (_tmp36_), _tmp37_);
		while (TRUE) {
			ValaFormalParameter* param;
			gboolean _tmp38_ = FALSE;
			gboolean _tmp39_ = FALSE;
			ValaCCodeExpression* arg;
			ValaFormalParameter* _tmp43_;
			ValaCCodeNode* _tmp44_;
			ValaCCodeExpression* _tmp45_;
			gboolean _tmp46_ = FALSE;
			if (!vala_iterator_next (_param_it)) {
				break;
			}
			param = (ValaFormalParameter*) vala_iterator_get (_param_it);
			if (first) {
				_tmp39_ = vala_delegate_get_sender_type (d) != NULL;
			} else {
				_tmp39_ = FALSE;
			}
			if (_tmp39_) {
				ValaList* _tmp40_;
				ValaList* _tmp41_;
				_tmp38_ = vala_collection_get_size ((ValaCollection*) (_tmp40_ = vala_method_get_parameters (m))) == (vala_collection_get_size ((ValaCollection*) (_tmp41_ = vala_delegate_get_parameters (d))) + 1);
				_vala_collection_object_unref0 (_tmp41_);
				_vala_collection_object_unref0 (_tmp40_);
			} else {
				_tmp38_ = FALSE;
			}
			if (_tmp38_) {
				ValaCCodeIdentifier* _tmp42_;
				vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cparameter_position (param), FALSE)), (ValaCCodeExpression*) (_tmp42_ = vala_ccode_identifier_new ("_sender")));
				_vala_ccode_node_unref0 (_tmp42_);
				first = FALSE;
				_vala_code_node_unref0 (param);
				continue;
			}
			arg = NULL;
			arg = (_tmp45_ = (ValaCCodeExpression*) vala_ccode_identifier_new (vala_ccode_formal_parameter_get_name ((_tmp44_ = vala_code_node_get_ccodenode ((ValaCodeNode*) (_tmp43_ = (ValaFormalParameter*) vala_list_get (d_params, i))), VALA_IS_CCODE_FORMAL_PARAMETER (_tmp44_) ? ((ValaCCodeFormalParameter*) _tmp44_) : NULL))), _vala_ccode_node_unref0 (arg), _tmp45_);
			_vala_code_node_unref0 (_tmp43_);
			vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cparameter_position (param), FALSE)), arg);
			if (!vala_formal_parameter_get_no_array_length (param)) {
				_tmp46_ = VALA_IS_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) param));
			} else {
				_tmp46_ = FALSE;
			}
			if (_tmp46_) {
				ValaArrayType* array_type;
				array_type = _vala_code_node_ref0 (VALA_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) param)));
				{
					gint dim;
					dim = 1;
					{
						gboolean _tmp47_;
						_tmp47_ = TRUE;
						while (TRUE) {
							ValaCCodeExpression* clength;
							ValaFormalParameter* _tmp48_;
							gboolean _tmp49_;
							if (!_tmp47_) {
								dim++;
							}
							_tmp47_ = FALSE;
							if (!(dim <= vala_array_type_get_rank (array_type))) {
								break;
							}
							clength = NULL;
							if ((_tmp49_ = vala_formal_parameter_get_array_null_terminated (_tmp48_ = (ValaFormalParameter*) vala_list_get (d_params, i)), _vala_code_node_unref0 (_tmp48_), _tmp49_)) {
								ValaCCodeIdentifier* _tmp50_;
								ValaCCodeFunctionCall* _tmp51_;
								ValaCCodeFunctionCall* len_call;
								ValaFormalParameter* _tmp52_;
								ValaCCodeIdentifier* _tmp53_;
								ValaCCodeExpression* _tmp54_;
								((ValaCCodeBaseModule*) self)->requires_array_length = TRUE;
								len_call = (_tmp51_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp50_ = vala_ccode_identifier_new ("_vala_array_length"))), _vala_ccode_node_unref0 (_tmp50_), _tmp51_);
								vala_ccode_function_call_add_argument (len_call, (ValaCCodeExpression*) (_tmp53_ = vala_ccode_identifier_new (vala_symbol_get_name ((ValaSymbol*) (_tmp52_ = (ValaFormalParameter*) vala_list_get (d_params, i))))));
								_vala_ccode_node_unref0 (_tmp53_);
								_vala_code_node_unref0 (_tmp52_);
								clength = (_tmp54_ = _vala_ccode_node_ref0 ((ValaCCodeExpression*) len_call), _vala_ccode_node_unref0 (clength), _tmp54_);
								_vala_ccode_node_unref0 (len_call);
							} else {
								ValaFormalParameter* _tmp55_;
								gboolean _tmp56_;
								if ((_tmp56_ = vala_formal_parameter_get_no_array_length (_tmp55_ = (ValaFormalParameter*) vala_list_get (d_params, i)), _vala_code_node_unref0 (_tmp55_), _tmp56_)) {
									ValaCCodeExpression* _tmp57_;
									clength = (_tmp57_ = (ValaCCodeExpression*) vala_ccode_constant_new ("-1"), _vala_ccode_node_unref0 (clength), _tmp57_);
								} else {
									ValaFormalParameter* _tmp58_;
									char* _tmp59_;
									ValaCCodeExpression* _tmp60_;
									clength = (_tmp60_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp59_ = vala_ccode_base_module_get_parameter_array_length_cname ((ValaCCodeBaseModule*) self, _tmp58_ = (ValaFormalParameter*) vala_list_get (d_params, i), dim)), _vala_ccode_node_unref0 (clength), _tmp60_);
									_g_free0 (_tmp59_);
									_vala_code_node_unref0 (_tmp58_);
								}
							}
							vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_carray_length_parameter_position (param) + (0.01 * dim), FALSE)), clength);
							_vala_ccode_node_unref0 (clength);
						}
					}
				}
				_vala_code_node_unref0 (array_type);
			} else {
				if (VALA_IS_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param))) {
					ValaDelegateType* deleg_type;
					deleg_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param)));
					if (vala_delegate_get_has_target (vala_delegate_type_get_delegate_symbol (deleg_type))) {
						ValaFormalParameter* _tmp61_;
						char* _tmp62_;
						ValaCCodeIdentifier* _tmp63_;
						ValaCCodeIdentifier* ctarget;
						ctarget = (_tmp63_ = vala_ccode_identifier_new (_tmp62_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) (_tmp61_ = (ValaFormalParameter*) vala_list_get (d_params, i))))), _g_free0 (_tmp62_), _vala_code_node_unref0 (_tmp61_), _tmp63_);
						vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param), FALSE)), (ValaCCodeExpression*) ctarget);
						_vala_ccode_node_unref0 (ctarget);
					}
					_vala_code_node_unref0 (deleg_type);
				}
			}
			i++;
			_vala_ccode_node_unref0 (arg);
			_vala_code_node_unref0 (param);
		}
		_vala_collection_object_unref0 (_param_it);
	}
	if (!vala_method_get_no_array_length (m)) {
		_tmp64_ = VALA_IS_ARRAY_TYPE (vala_method_get_return_type (m));
	} else {
		_tmp64_ = FALSE;
	}
	if (_tmp64_) {
		ValaArrayType* array_type;
		array_type = _vala_code_node_ref0 (VALA_ARRAY_TYPE (vala_method_get_return_type (m)));
		{
			gint dim;
			dim = 1;
			{
				gboolean _tmp65_;
				_tmp65_ = TRUE;
				while (TRUE) {
					ValaCCodeExpression* clength;
					if (!_tmp65_) {
						dim++;
					}
					_tmp65_ = FALSE;
					if (!(dim <= vala_array_type_get_rank (array_type))) {
						break;
					}
					clength = NULL;
					if (vala_delegate_get_no_array_length (d)) {
						ValaCCodeExpression* _tmp66_;
						clength = (_tmp66_ = (ValaCCodeExpression*) vala_ccode_constant_new ("NULL"), _vala_ccode_node_unref0 (clength), _tmp66_);
					} else {
						char* _tmp67_;
						ValaCCodeExpression* _tmp68_;
						clength = (_tmp68_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp67_ = vala_ccode_base_module_get_array_length_cname ((ValaCCodeBaseModule*) self, "result", dim)), _vala_ccode_node_unref0 (clength), _tmp68_);
						_g_free0 (_tmp67_);
					}
					vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_method_get_carray_length_parameter_position (m) + (0.01 * dim), FALSE)), clength);
					_vala_ccode_node_unref0 (clength);
				}
			}
		}
		_vala_code_node_unref0 (array_type);
	} else {
		if (VALA_IS_DELEGATE_TYPE (vala_method_get_return_type (m))) {
			ValaDelegateType* deleg_type;
			deleg_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_method_get_return_type (m)));
			if (vala_delegate_get_has_target (vala_delegate_type_get_delegate_symbol (deleg_type))) {
				char* _tmp69_;
				ValaCCodeIdentifier* _tmp70_;
				ValaCCodeIdentifier* ctarget;
				ctarget = (_tmp70_ = vala_ccode_identifier_new (_tmp69_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, "result")), _g_free0 (_tmp69_), _tmp70_);
				vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_method_get_cdelegate_target_parameter_position (m), FALSE)), (ValaCCodeExpression*) ctarget);
				_vala_ccode_node_unref0 (ctarget);
			}
			_vala_code_node_unref0 (deleg_type);
		} else {
			if (vala_data_type_is_real_non_null_struct_type (vala_method_get_return_type (m))) {
				ValaCCodeIdentifier* _tmp71_;
				vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, (double) (-3), FALSE)), (ValaCCodeExpression*) (_tmp71_ = vala_ccode_identifier_new ("result")));
				_vala_ccode_node_unref0 (_tmp71_);
			}
		}
	}
	if ((_tmp73_ = vala_collection_get_size ((ValaCollection*) (_tmp72_ = vala_code_node_get_error_types ((ValaCodeNode*) m))) > 0, _vala_collection_object_unref0 (_tmp72_), _tmp73_)) {
		ValaCCodeIdentifier* _tmp74_;
		vala_map_set ((ValaMap*) carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, (double) (-1), FALSE)), (ValaCCodeExpression*) (_tmp74_ = vala_ccode_identifier_new ("error")));
		_vala_ccode_node_unref0 (_tmp74_);
	}
	ccall = (_tmp77_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp76_ = vala_ccode_identifier_new (_tmp75_ = vala_method_get_cname (m)))), _vala_ccode_node_unref0 (_tmp76_), _g_free0 (_tmp75_), _tmp77_);
	last_pos = -1;
	while (TRUE) {
		ValaCCodeExpression* _tmp82_;
		min_pos = -1;
		{
			ValaSet* _tmp78_;
			ValaIterator* _tmp79_;
			ValaIterator* _pos_it;
			_pos_it = (_tmp79_ = vala_iterable_iterator ((ValaIterable*) (_tmp78_ = vala_map_get_keys ((ValaMap*) carg_map))), _vala_collection_object_unref0 (_tmp78_), _tmp79_);
			while (TRUE) {
				gint pos;
				gboolean _tmp80_ = FALSE;
				if (!vala_iterator_next (_pos_it)) {
					break;
				}
				pos = GPOINTER_TO_INT (vala_iterator_get (_pos_it));
				if (pos > last_pos) {
					gboolean _tmp81_ = FALSE;
					if (min_pos == (-1)) {
						_tmp81_ = TRUE;
					} else {
						_tmp81_ = pos < min_pos;
					}
					_tmp80_ = _tmp81_;
				} else {
					_tmp80_ = FALSE;
				}
				if (_tmp80_) {
					min_pos = pos;
				}
			}
			_vala_collection_object_unref0 (_pos_it);
		}
		if (min_pos == (-1)) {
			break;
		}
		vala_ccode_function_call_add_argument (ccall, _tmp82_ = (ValaCCodeExpression*) vala_map_get ((ValaMap*) carg_map, GINT_TO_POINTER (min_pos)));
		_vala_ccode_node_unref0 (_tmp82_);
		last_pos = min_pos;
	}
	block = vala_ccode_block_new ();
	if (VALA_IS_VOID_TYPE (vala_method_get_return_type (m))) {
		_tmp83_ = TRUE;
	} else {
		_tmp83_ = vala_data_type_is_real_non_null_struct_type (vala_method_get_return_type (m));
	}
	if (_tmp83_) {
		ValaCCodeExpressionStatement* _tmp84_;
		vala_ccode_block_add_statement (block, (ValaCCodeNode*) (_tmp84_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) ccall)));
		_vala_ccode_node_unref0 (_tmp84_);
	} else {
		ValaCCodeDeclaration* _cdecl_;
		ValaCCodeVariableDeclarator* _tmp85_;
		_cdecl_ = vala_ccode_declaration_new (return_type_cname);
		vala_ccode_declaration_add_declarator (_cdecl_, (ValaCCodeDeclarator*) (_tmp85_ = vala_ccode_variable_declarator_new ("result", (ValaCCodeExpression*) ccall, NULL)));
		_vala_ccode_node_unref0 (_tmp85_);
		vala_ccode_block_add_statement (block, (ValaCCodeNode*) _cdecl_);
		_vala_ccode_node_unref0 (_cdecl_);
	}
	if (vala_delegate_get_has_target (d)) {
		_tmp88_ = !vala_data_type_get_value_owned ((ValaDataType*) dt);
	} else {
		_tmp88_ = FALSE;
	}
	if (_tmp88_) {
		_tmp87_ = vala_delegate_type_get_is_called_once (dt);
	} else {
		_tmp87_ = FALSE;
	}
	if (_tmp87_) {
		_tmp86_ = expr != NULL;
	} else {
		_tmp86_ = FALSE;
	}
	if (_tmp86_) {
		ValaCCodeExpression* destroy_notify;
		destroy_notify = NULL;
		if (VALA_IS_LAMBDA_EXPRESSION (expr)) {
			ValaLambdaExpression* lambda;
			lambda = _vala_code_node_ref0 (VALA_LAMBDA_EXPRESSION (expr));
			if (vala_method_get_closure (vala_lambda_expression_get_method (lambda))) {
				gint block_id;
				char* _tmp89_;
				ValaCCodeExpression* _tmp90_;
				block_id = vala_ccode_base_module_get_block_id ((ValaCCodeBaseModule*) self, vala_ccode_base_module_get_current_closure_block ((ValaCCodeBaseModule*) self));
				destroy_notify = (_tmp90_ = (ValaCCodeExpression*) vala_ccode_identifier_new (_tmp89_ = g_strdup_printf ("block%d_data_unref", block_id)), _vala_ccode_node_unref0 (destroy_notify), _tmp90_);
				_g_free0 (_tmp89_);
			} else {
				ValaDataType* _tmp91_;
				gboolean _tmp92_;
				if ((_tmp92_ = (_tmp91_ = vala_ccode_base_module_get_this_type ((ValaCCodeBaseModule*) self)) != NULL, _vala_code_node_unref0 (_tmp91_), _tmp92_)) {
					ValaDataType* _tmp93_;
					ValaCCodeExpression* _tmp94_;
					destroy_notify = (_tmp94_ = vala_ccode_base_module_get_destroy_func_expression ((ValaCCodeBaseModule*) self, _tmp93_ = vala_ccode_base_module_get_this_type ((ValaCCodeBaseModule*) self), FALSE), _vala_ccode_node_unref0 (destroy_notify), _tmp94_);
					_vala_code_node_unref0 (_tmp93_);
				} else {
					if (((ValaCCodeBaseModule*) self)->in_constructor) {
						ValaCCodeExpression* _tmp95_;
						destroy_notify = (_tmp95_ = (ValaCCodeExpression*) vala_ccode_identifier_new ("g_object_unref"), _vala_ccode_node_unref0 (destroy_notify), _tmp95_);
					}
				}
			}
			_vala_code_node_unref0 (lambda);
		} else {
			if (VALA_IS_METHOD (vala_expression_get_symbol_reference (expr))) {
				ValaMemberAccess* ma;
				gboolean _tmp96_ = FALSE;
				gboolean _tmp97_ = FALSE;
				gboolean _tmp98_ = FALSE;
				ma = _vala_code_node_ref0 (VALA_MEMBER_ACCESS (expr));
				if (vala_method_get_binding (m) != MEMBER_BINDING_STATIC) {
					_tmp98_ = !vala_method_get_is_async_callback (m);
				} else {
					_tmp98_ = FALSE;
				}
				if (_tmp98_) {
					_tmp97_ = vala_data_type_get_data_type (vala_expression_get_value_type (vala_member_access_get_inner (ma))) != NULL;
				} else {
					_tmp97_ = FALSE;
				}
				if (_tmp97_) {
					_tmp96_ = vala_typesymbol_is_reference_counting (vala_data_type_get_data_type (vala_expression_get_value_type (vala_member_access_get_inner (ma))));
				} else {
					_tmp96_ = FALSE;
				}
				if (_tmp96_) {
					ValaCCodeExpression* _tmp99_;
					destroy_notify = (_tmp99_ = vala_ccode_base_module_get_destroy_func_expression ((ValaCCodeBaseModule*) self, vala_expression_get_value_type (vala_member_access_get_inner (ma)), FALSE), _vala_ccode_node_unref0 (destroy_notify), _tmp99_);
				}
				_vala_code_node_unref0 (ma);
			}
		}
		if (destroy_notify != NULL) {
			ValaCCodeFunctionCall* unref_call;
			ValaCCodeIdentifier* _tmp100_;
			ValaCCodeExpressionStatement* _tmp101_;
			unref_call = vala_ccode_function_call_new (destroy_notify);
			vala_ccode_function_call_add_argument (unref_call, (ValaCCodeExpression*) (_tmp100_ = vala_ccode_identifier_new ("self")));
			_vala_ccode_node_unref0 (_tmp100_);
			vala_ccode_block_add_statement (block, (ValaCCodeNode*) (_tmp101_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) unref_call)));
			_vala_ccode_node_unref0 (_tmp101_);
			_vala_ccode_node_unref0 (unref_call);
		}
		_vala_ccode_node_unref0 (destroy_notify);
	}
	if (VALA_IS_VOID_TYPE (vala_method_get_return_type (m))) {
		_tmp102_ = TRUE;
	} else {
		_tmp102_ = vala_data_type_is_real_non_null_struct_type (vala_method_get_return_type (m));
	}
	if (!_tmp102_) {
		ValaCCodeIdentifier* _tmp103_;
		ValaCCodeReturnStatement* _tmp104_;
		vala_ccode_block_add_statement (block, (ValaCCodeNode*) (_tmp104_ = vala_ccode_return_statement_new ((ValaCCodeExpression*) (_tmp103_ = vala_ccode_identifier_new ("result")))));
		_vala_ccode_node_unref0 (_tmp104_);
		_vala_ccode_node_unref0 (_tmp103_);
	}
	vala_ccode_declaration_space_add_type_member_declaration (((ValaCCodeBaseModule*) self)->source_declarations, (ValaCCodeNode*) (_tmp105_ = vala_ccode_function_copy (function)));
	_vala_ccode_node_unref0 (_tmp105_);
	vala_ccode_function_set_block (function, block);
	vala_ccode_fragment_append (((ValaCCodeBaseModule*) self)->source_type_member_definition, (ValaCCodeNode*) function);
	result = wrapper_name;
	_vala_ccode_node_unref0 (block);
	_vala_ccode_node_unref0 (ccall);
	_vala_collection_object_unref0 (carg_map);
	_vala_collection_object_unref0 (d_params);
	_vala_collection_object_unref0 (cparam_map);
	_vala_ccode_node_unref0 (function);
	_g_free0 (return_type_cname);
	_vala_code_node_unref0 (dynamic_sig);
	_vala_code_node_unref0 (sig);
	_g_free0 (delegate_name);
	_vala_code_node_unref0 (d);
	return result;
}


static void vala_ccode_delegate_module_real_generate_parameter (ValaCCodeMethodModule* base, ValaFormalParameter* param, ValaCCodeDeclarationSpace* decl_space, ValaMap* cparam_map, ValaMap* carg_map) {
	ValaCCodeDelegateModule * self;
	gboolean _tmp0_ = FALSE;
	char* ctypename;
	char* target_ctypename;
	char* target_destroy_notify_ctypename;
	gboolean _tmp1_ = FALSE;
	char* _tmp8_;
	ValaCCodeFormalParameter* _tmp9_;
	self = (ValaCCodeDelegateModule*) base;
	g_return_if_fail (param != NULL);
	g_return_if_fail (decl_space != NULL);
	g_return_if_fail (cparam_map != NULL);
	if (VALA_IS_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param))) {
		_tmp0_ = TRUE;
	} else {
		_tmp0_ = VALA_IS_METHOD_TYPE (vala_variable_get_variable_type ((ValaVariable*) param));
	}
	if (!_tmp0_) {
		VALA_CCODE_METHOD_MODULE_CLASS (vala_ccode_delegate_module_parent_class)->generate_parameter ((ValaCCodeMethodModule*) VALA_CCODE_ARRAY_MODULE (self), param, decl_space, cparam_map, carg_map);
		return;
	}
	ctypename = vala_data_type_get_cname (vala_variable_get_variable_type ((ValaVariable*) param));
	target_ctypename = g_strdup ("void*");
	target_destroy_notify_ctypename = g_strdup ("GDestroyNotify");
	if (VALA_IS_DELEGATE (vala_symbol_get_parent_symbol ((ValaSymbol*) param))) {
		char* _tmp2_;
		char* _tmp3_;
		_tmp1_ = _vala_strcmp0 (_tmp2_ = vala_data_type_get_cname (vala_variable_get_variable_type ((ValaVariable*) param)), _tmp3_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) VALA_DELEGATE (vala_symbol_get_parent_symbol ((ValaSymbol*) param)), FALSE)) == 0;
		_g_free0 (_tmp3_);
		_g_free0 (_tmp2_);
	} else {
		_tmp1_ = FALSE;
	}
	if (_tmp1_) {
		char* _tmp4_;
		ctypename = (_tmp4_ = g_strdup ("GCallback"), _g_free0 (ctypename), _tmp4_);
	}
	if (vala_formal_parameter_get_direction (param) != VALA_PARAMETER_DIRECTION_IN) {
		char* _tmp5_;
		char* _tmp6_;
		char* _tmp7_;
		ctypename = (_tmp5_ = g_strconcat (ctypename, "*", NULL), _g_free0 (ctypename), _tmp5_);
		target_ctypename = (_tmp6_ = g_strconcat (target_ctypename, "*", NULL), _g_free0 (target_ctypename), _tmp6_);
		target_destroy_notify_ctypename = (_tmp7_ = g_strconcat (target_destroy_notify_ctypename, "*", NULL), _g_free0 (target_destroy_notify_ctypename), _tmp7_);
	}
	vala_code_node_set_ccodenode ((ValaCodeNode*) param, (ValaCCodeNode*) (_tmp9_ = vala_ccode_formal_parameter_new (_tmp8_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)), ctypename)));
	_vala_ccode_node_unref0 (_tmp9_);
	_g_free0 (_tmp8_);
	vala_map_set (cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cparameter_position (param), FALSE)), VALA_CCODE_FORMAL_PARAMETER (vala_code_node_get_ccodenode ((ValaCodeNode*) param)));
	if (carg_map != NULL) {
		ValaCCodeExpression* _tmp10_;
		vala_map_set (carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cparameter_position (param), FALSE)), _tmp10_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param)));
		_vala_ccode_node_unref0 (_tmp10_);
	}
	if (VALA_IS_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param))) {
		ValaDelegateType* deleg_type;
		ValaDelegate* d;
		deleg_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) param)));
		d = _vala_code_node_ref0 (vala_delegate_type_get_delegate_symbol (deleg_type));
		vala_ccode_base_module_generate_delegate_declaration ((ValaCCodeBaseModule*) self, d, decl_space);
		if (vala_delegate_get_has_target (d)) {
			char* _tmp11_;
			char* _tmp12_;
			ValaCCodeFormalParameter* _tmp13_;
			ValaCCodeFormalParameter* cparam;
			cparam = (_tmp13_ = vala_ccode_formal_parameter_new (_tmp12_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp11_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param))), target_ctypename), _g_free0 (_tmp12_), _g_free0 (_tmp11_), _tmp13_);
			vala_map_set (cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param), FALSE)), cparam);
			if (carg_map != NULL) {
				ValaCCodeExpression* _tmp14_;
				vala_map_set (carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param), FALSE)), _tmp14_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, vala_ccode_formal_parameter_get_name (cparam)));
				_vala_ccode_node_unref0 (_tmp14_);
			}
			if (vala_data_type_get_value_owned ((ValaDataType*) deleg_type)) {
				char* _tmp15_;
				char* _tmp16_;
				ValaCCodeFormalParameter* _tmp17_;
				cparam = (_tmp17_ = vala_ccode_formal_parameter_new (_tmp16_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, _tmp15_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param))), target_destroy_notify_ctypename), _vala_ccode_node_unref0 (cparam), _tmp17_);
				_g_free0 (_tmp16_);
				_g_free0 (_tmp15_);
				vala_map_set (cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param) + 0.01, FALSE)), cparam);
				if (carg_map != NULL) {
					ValaCCodeExpression* _tmp18_;
					vala_map_set (carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param) + 0.01, FALSE)), _tmp18_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, vala_ccode_formal_parameter_get_name (cparam)));
					_vala_ccode_node_unref0 (_tmp18_);
				}
			}
			_vala_ccode_node_unref0 (cparam);
		}
		_vala_code_node_unref0 (d);
		_vala_code_node_unref0 (deleg_type);
	} else {
		if (VALA_IS_METHOD_TYPE (vala_variable_get_variable_type ((ValaVariable*) param))) {
			char* _tmp19_;
			char* _tmp20_;
			ValaCCodeFormalParameter* _tmp21_;
			ValaCCodeFormalParameter* cparam;
			cparam = (_tmp21_ = vala_ccode_formal_parameter_new (_tmp20_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, _tmp19_ = vala_ccode_base_module_get_variable_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) param))), target_ctypename), _g_free0 (_tmp20_), _g_free0 (_tmp19_), _tmp21_);
			vala_map_set (cparam_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param), FALSE)), cparam);
			if (carg_map != NULL) {
				ValaCCodeExpression* _tmp22_;
				vala_map_set (carg_map, GINT_TO_POINTER (vala_ccode_base_module_get_param_pos ((ValaCCodeBaseModule*) self, vala_formal_parameter_get_cdelegate_target_parameter_position (param), FALSE)), _tmp22_ = vala_ccode_base_module_get_variable_cexpression ((ValaCCodeBaseModule*) self, vala_ccode_formal_parameter_get_name (cparam)));
				_vala_ccode_node_unref0 (_tmp22_);
			}
			_vala_ccode_node_unref0 (cparam);
		}
	}
	_g_free0 (target_destroy_notify_ctypename);
	_g_free0 (target_ctypename);
	_g_free0 (ctypename);
}


ValaCCodeDelegateModule* vala_ccode_delegate_module_construct (GType object_type) {
	ValaCCodeDelegateModule* self = NULL;
	self = (ValaCCodeDelegateModule*) vala_ccode_array_module_construct (object_type);
	return self;
}


ValaCCodeDelegateModule* vala_ccode_delegate_module_new (void) {
	return vala_ccode_delegate_module_construct (VALA_TYPE_CCODE_DELEGATE_MODULE);
}


static void vala_ccode_delegate_module_class_init (ValaCCodeDelegateModuleClass * klass) {
	vala_ccode_delegate_module_parent_class = g_type_class_peek_parent (klass);
	VALA_CCODE_BASE_MODULE_CLASS (klass)->generate_delegate_declaration = vala_ccode_delegate_module_real_generate_delegate_declaration;
	VALA_CODE_VISITOR_CLASS (klass)->visit_delegate = vala_ccode_delegate_module_real_visit_delegate;
	VALA_CCODE_BASE_MODULE_CLASS (klass)->get_delegate_target_cname = vala_ccode_delegate_module_real_get_delegate_target_cname;
	VALA_CCODE_BASE_MODULE_CLASS (klass)->get_delegate_target_cexpression = vala_ccode_delegate_module_real_get_delegate_target_cexpression;
	VALA_CCODE_BASE_MODULE_CLASS (klass)->get_delegate_target_destroy_notify_cname = vala_ccode_delegate_module_real_get_delegate_target_destroy_notify_cname;
	VALA_CCODE_BASE_MODULE_CLASS (klass)->get_implicit_cast_expression = vala_ccode_delegate_module_real_get_implicit_cast_expression;
	VALA_CCODE_METHOD_MODULE_CLASS (klass)->generate_parameter = vala_ccode_delegate_module_real_generate_parameter;
}


static void vala_ccode_delegate_module_instance_init (ValaCCodeDelegateModule * self) {
}


/**
 * The link between an assignment and generated code.
 */
GType vala_ccode_delegate_module_get_type (void) {
	static volatile gsize vala_ccode_delegate_module_type_id__volatile = 0;
	if (g_once_init_enter (&vala_ccode_delegate_module_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (ValaCCodeDelegateModuleClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) vala_ccode_delegate_module_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ValaCCodeDelegateModule), 0, (GInstanceInitFunc) vala_ccode_delegate_module_instance_init, NULL };
		GType vala_ccode_delegate_module_type_id;
		vala_ccode_delegate_module_type_id = g_type_register_static (VALA_TYPE_CCODE_ARRAY_MODULE, "ValaCCodeDelegateModule", &g_define_type_info, 0);
		g_once_init_leave (&vala_ccode_delegate_module_type_id__volatile, vala_ccode_delegate_module_type_id);
	}
	return vala_ccode_delegate_module_type_id__volatile;
}


static int _vala_strcmp0 (const char * str1, const char * str2) {
	if (str1 == NULL) {
		return -(str1 != str2);
	}
	if (str2 == NULL) {
		return str1 != str2;
	}
	return strcmp (str1, str2);
}




