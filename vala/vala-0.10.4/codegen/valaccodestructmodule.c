/* valaccodestructmodule.c generated by valac, the Vala compiler
 * generated from valaccodestructmodule.vala, do not modify */

/* valaccodestructmodule.vala
 *
 * Copyright (C) 2006-2009  Jürg Billeter
 * Copyright (C) 2006-2008  Raffaele Sandrini
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.

 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.

 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
 *
 * Author:
 * 	Jürg Billeter <j@bitron.ch>
 *	Raffaele Sandrini <raffaele@sandrini.ch>
 */

#include <glib.h>
#include <glib-object.h>
#include <vala.h>
#include <valagee.h>
#include <valaccode.h>
#include <stdlib.h>
#include <string.h>


#define VALA_TYPE_CCODE_BASE_MODULE (vala_ccode_base_module_get_type ())
#define VALA_CCODE_BASE_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_BASE_MODULE, ValaCCodeBaseModule))
#define VALA_CCODE_BASE_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_BASE_MODULE, ValaCCodeBaseModuleClass))
#define VALA_IS_CCODE_BASE_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_BASE_MODULE))
#define VALA_IS_CCODE_BASE_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_BASE_MODULE))
#define VALA_CCODE_BASE_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_BASE_MODULE, ValaCCodeBaseModuleClass))

typedef struct _ValaCCodeBaseModule ValaCCodeBaseModule;
typedef struct _ValaCCodeBaseModuleClass ValaCCodeBaseModuleClass;
typedef struct _ValaCCodeBaseModulePrivate ValaCCodeBaseModulePrivate;

#define VALA_TYPE_CCODE_DECLARATION_SPACE (vala_ccode_declaration_space_get_type ())
#define VALA_CCODE_DECLARATION_SPACE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_DECLARATION_SPACE, ValaCCodeDeclarationSpace))
#define VALA_CCODE_DECLARATION_SPACE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_DECLARATION_SPACE, ValaCCodeDeclarationSpaceClass))
#define VALA_IS_CCODE_DECLARATION_SPACE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_DECLARATION_SPACE))
#define VALA_IS_CCODE_DECLARATION_SPACE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_DECLARATION_SPACE))
#define VALA_CCODE_DECLARATION_SPACE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_DECLARATION_SPACE, ValaCCodeDeclarationSpaceClass))

typedef struct _ValaCCodeDeclarationSpace ValaCCodeDeclarationSpace;
typedef struct _ValaCCodeDeclarationSpaceClass ValaCCodeDeclarationSpaceClass;

#define VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT (vala_ccode_base_module_emit_context_get_type ())
#define VALA_CCODE_BASE_MODULE_EMIT_CONTEXT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT, ValaCCodeBaseModuleEmitContext))
#define VALA_CCODE_BASE_MODULE_EMIT_CONTEXT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT, ValaCCodeBaseModuleEmitContextClass))
#define VALA_CCODE_BASE_MODULE_IS_EMIT_CONTEXT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT))
#define VALA_CCODE_BASE_MODULE_IS_EMIT_CONTEXT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT))
#define VALA_CCODE_BASE_MODULE_EMIT_CONTEXT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_CCODE_BASE_MODULE_TYPE_EMIT_CONTEXT, ValaCCodeBaseModuleEmitContextClass))

typedef struct _ValaCCodeBaseModuleEmitContext ValaCCodeBaseModuleEmitContext;
typedef struct _ValaCCodeBaseModuleEmitContextClass ValaCCodeBaseModuleEmitContextClass;

#define VALA_TYPE_CCODE_STRUCT_MODULE (vala_ccode_struct_module_get_type ())
#define VALA_CCODE_STRUCT_MODULE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_CCODE_STRUCT_MODULE, ValaCCodeStructModule))
#define VALA_CCODE_STRUCT_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_CCODE_STRUCT_MODULE, ValaCCodeStructModuleClass))
#define VALA_IS_CCODE_STRUCT_MODULE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_CCODE_STRUCT_MODULE))
#define VALA_IS_CCODE_STRUCT_MODULE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_CCODE_STRUCT_MODULE))
#define VALA_CCODE_STRUCT_MODULE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_CCODE_STRUCT_MODULE, ValaCCodeStructModuleClass))

typedef struct _ValaCCodeStructModule ValaCCodeStructModule;
typedef struct _ValaCCodeStructModuleClass ValaCCodeStructModuleClass;
typedef struct _ValaCCodeStructModulePrivate ValaCCodeStructModulePrivate;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _vala_ccode_node_unref0(var) ((var == NULL) ? NULL : (var = (vala_ccode_node_unref (var), NULL)))

#define VALA_TYPE_TYPEREGISTER_FUNCTION (vala_typeregister_function_get_type ())
#define VALA_TYPEREGISTER_FUNCTION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_TYPEREGISTER_FUNCTION, ValaTypeRegisterFunction))
#define VALA_TYPEREGISTER_FUNCTION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_TYPEREGISTER_FUNCTION, ValaTypeRegisterFunctionClass))
#define VALA_IS_TYPEREGISTER_FUNCTION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_TYPEREGISTER_FUNCTION))
#define VALA_IS_TYPEREGISTER_FUNCTION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_TYPEREGISTER_FUNCTION))
#define VALA_TYPEREGISTER_FUNCTION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_TYPEREGISTER_FUNCTION, ValaTypeRegisterFunctionClass))

typedef struct _ValaTypeRegisterFunction ValaTypeRegisterFunction;
typedef struct _ValaTypeRegisterFunctionClass ValaTypeRegisterFunctionClass;

#define VALA_TYPE_STRUCT_REGISTER_FUNCTION (vala_struct_register_function_get_type ())
#define VALA_STRUCT_REGISTER_FUNCTION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), VALA_TYPE_STRUCT_REGISTER_FUNCTION, ValaStructRegisterFunction))
#define VALA_STRUCT_REGISTER_FUNCTION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), VALA_TYPE_STRUCT_REGISTER_FUNCTION, ValaStructRegisterFunctionClass))
#define VALA_IS_STRUCT_REGISTER_FUNCTION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), VALA_TYPE_STRUCT_REGISTER_FUNCTION))
#define VALA_IS_STRUCT_REGISTER_FUNCTION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), VALA_TYPE_STRUCT_REGISTER_FUNCTION))
#define VALA_STRUCT_REGISTER_FUNCTION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), VALA_TYPE_STRUCT_REGISTER_FUNCTION, ValaStructRegisterFunctionClass))

typedef struct _ValaStructRegisterFunction ValaStructRegisterFunction;
typedef struct _ValaStructRegisterFunctionClass ValaStructRegisterFunctionClass;
#define _vala_typeregister_function_unref0(var) ((var == NULL) ? NULL : (var = (vala_typeregister_function_unref (var), NULL)))
#define _vala_collection_object_unref0(var) ((var == NULL) ? NULL : (var = (vala_collection_object_unref (var), NULL)))
#define _vala_code_node_unref0(var) ((var == NULL) ? NULL : (var = (vala_code_node_unref (var), NULL)))
#define _vala_ccode_base_module_emit_context_unref0(var) ((var == NULL) ? NULL : (var = (vala_ccode_base_module_emit_context_unref (var), NULL)))

struct _ValaCCodeBaseModule {
	ValaCodeGenerator parent_instance;
	ValaCCodeBaseModulePrivate * priv;
	ValaSymbol* root_symbol;
	ValaCCodeBaseModuleEmitContext* emit_context;
	ValaCCodeDeclarationSpace* header_declarations;
	ValaCCodeDeclarationSpace* internal_header_declarations;
	ValaCCodeDeclarationSpace* source_declarations;
	ValaCCodeFragment* source_signal_marshaller_declaration;
	ValaCCodeFragment* source_type_member_definition;
	ValaCCodeFragment* class_init_fragment;
	ValaCCodeFragment* base_init_fragment;
	ValaCCodeFragment* class_finalize_fragment;
	ValaCCodeFragment* base_finalize_fragment;
	ValaCCodeFragment* instance_init_fragment;
	ValaCCodeFragment* instance_finalize_fragment;
	ValaCCodeFragment* source_signal_marshaller_definition;
	ValaCCodeStruct* param_spec_struct;
	ValaCCodeStruct* closure_struct;
	ValaCCodeEnum* prop_enum;
	ValaCCodeFunction* function;
	ValaCCodeFragment* pre_statement_fragment;
	ValaSet* user_marshal_set;
	ValaSet* predefined_marshal_set;
	gint next_regex_id;
	gboolean in_constructor;
	gboolean in_static_or_class_context;
	gint next_coroutine_state;
	ValaDataType* void_type;
	ValaDataType* bool_type;
	ValaDataType* char_type;
	ValaDataType* uchar_type;
	ValaDataType* unichar_type;
	ValaDataType* short_type;
	ValaDataType* ushort_type;
	ValaDataType* int_type;
	ValaDataType* uint_type;
	ValaDataType* long_type;
	ValaDataType* ulong_type;
	ValaDataType* int8_type;
	ValaDataType* uint8_type;
	ValaDataType* int16_type;
	ValaDataType* uint16_type;
	ValaDataType* int32_type;
	ValaDataType* uint32_type;
	ValaDataType* int64_type;
	ValaDataType* uint64_type;
	ValaDataType* string_type;
	ValaDataType* regex_type;
	ValaDataType* float_type;
	ValaDataType* double_type;
	ValaTypeSymbol* gtype_type;
	ValaTypeSymbol* gobject_type;
	ValaErrorType* gerror_type;
	ValaClass* glist_type;
	ValaClass* gslist_type;
	ValaClass* gnode_type;
	ValaClass* gvaluearray_type;
	ValaTypeSymbol* gstringbuilder_type;
	ValaTypeSymbol* garray_type;
	ValaTypeSymbol* gbytearray_type;
	ValaTypeSymbol* gptrarray_type;
	ValaTypeSymbol* gthreadpool_type;
	ValaDataType* gquark_type;
	ValaStruct* gvalue_type;
	ValaClass* gvariant_type;
	ValaStruct* mutex_type;
	ValaTypeSymbol* type_module_type;
	ValaTypeSymbol* dbus_proxy_type;
	ValaTypeSymbol* dbus_object_type;
	gboolean in_plugin;
	char* module_init_param_name;
	gboolean gvaluecollector_h_needed;
	gboolean requires_array_free;
	gboolean requires_array_move;
	gboolean requires_array_length;
	gboolean requires_strcmp0;
	ValaSet* wrappers;
};

struct _ValaCCodeBaseModuleClass {
	ValaCodeGeneratorClass parent_class;
	void (*append_vala_array_free) (ValaCCodeBaseModule* self);
	void (*append_vala_array_move) (ValaCCodeBaseModule* self);
	void (*append_vala_array_length) (ValaCCodeBaseModule* self);
	gboolean (*generate_enum_declaration) (ValaCCodeBaseModule* self, ValaEnum* en, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_class_struct_declaration) (ValaCCodeBaseModule* self, ValaClass* cl, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_struct_declaration) (ValaCCodeBaseModule* self, ValaStruct* st, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_delegate_declaration) (ValaCCodeBaseModule* self, ValaDelegate* d, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_cparameters) (ValaCCodeBaseModule* self, ValaMethod* m, ValaCCodeDeclarationSpace* decl_space, ValaMap* cparam_map, ValaCCodeFunction* func, ValaCCodeFunctionDeclarator* vdeclarator, ValaMap* carg_map, ValaCCodeFunctionCall* vcall, gint direction);
	ValaCCodeExpression* (*get_dup_func_expression) (ValaCCodeBaseModule* self, ValaDataType* type, ValaSourceReference* source_reference, gboolean is_chainup);
	char* (*append_struct_array_free) (ValaCCodeBaseModule* self, ValaStruct* st);
	ValaCCodeExpression* (*get_unref_expression) (ValaCCodeBaseModule* self, ValaCCodeExpression* cvar, ValaDataType* type, ValaExpression* expr, gboolean is_macro_definition);
	void (*append_local_free) (ValaCCodeBaseModule* self, ValaSymbol* sym, ValaCCodeFragment* cfrag, gboolean stop_at_loop);
	char* (*get_delegate_target_cname) (ValaCCodeBaseModule* self, const char* delegate_cname);
	ValaCCodeExpression* (*get_delegate_target_cexpression) (ValaCCodeBaseModule* self, ValaExpression* delegate_expr, ValaCCodeExpression** delegate_target_destroy_notify);
	char* (*get_delegate_target_destroy_notify_cname) (ValaCCodeBaseModule* self, const char* delegate_cname);
	ValaCCodeExpression* (*get_ref_cexpression) (ValaCCodeBaseModule* self, ValaDataType* expression_type, ValaCCodeExpression* cexpr, ValaExpression* expr, ValaCodeNode* node);
	void (*generate_class_declaration) (ValaCCodeBaseModule* self, ValaClass* cl, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_interface_declaration) (ValaCCodeBaseModule* self, ValaInterface* iface, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_method_declaration) (ValaCCodeBaseModule* self, ValaMethod* m, ValaCCodeDeclarationSpace* decl_space);
	void (*generate_error_domain_declaration) (ValaCCodeBaseModule* self, ValaErrorDomain* edomain, ValaCCodeDeclarationSpace* decl_space);
	ValaCCodeExpression* (*deserialize_expression) (ValaCCodeBaseModule* self, ValaCCodeFragment* fragment, ValaDataType* type, ValaCCodeExpression* variant_expr, ValaCCodeExpression* expr);
	ValaCCodeExpression* (*serialize_expression) (ValaCCodeBaseModule* self, ValaCCodeFragment* fragment, ValaDataType* type, ValaCCodeExpression* expr);
	ValaCCodeExpression* (*get_implicit_cast_expression) (ValaCCodeBaseModule* self, ValaCCodeExpression* source_cexpr, ValaDataType* expression_type, ValaDataType* target_type, ValaExpression* expr);
	gboolean (*is_gobject_property) (ValaCCodeBaseModule* self, ValaProperty* prop);
	char* (*get_custom_creturn_type) (ValaCCodeBaseModule* self, ValaMethod* m);
	void (*generate_dynamic_method_wrapper) (ValaCCodeBaseModule* self, ValaDynamicMethod* method);
	gboolean (*method_has_wrapper) (ValaCCodeBaseModule* self, ValaMethod* method);
	ValaCCodeExpression* (*get_construct_property_assignment) (ValaCCodeBaseModule* self, ValaCCodeConstant* canonical_cconstant, ValaDataType* property_type, ValaCCodeExpression* value);
	ValaCCodeFunctionCall* (*get_param_spec) (ValaCCodeBaseModule* self, ValaProperty* prop);
	ValaCCodeFunctionCall* (*get_signal_creation) (ValaCCodeBaseModule* self, ValaSignal* sig, ValaTypeSymbol* type);
	ValaCCodeFragment* (*register_dbus_info) (ValaCCodeBaseModule* self, ValaObjectTypeSymbol* bindable);
	char* (*get_dynamic_property_getter_cname) (ValaCCodeBaseModule* self, ValaDynamicProperty* node);
	char* (*get_dynamic_property_setter_cname) (ValaCCodeBaseModule* self, ValaDynamicProperty* node);
	char* (*get_dynamic_signal_cname) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	char* (*get_dynamic_signal_connect_wrapper_name) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	char* (*get_dynamic_signal_connect_after_wrapper_name) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	char* (*get_dynamic_signal_disconnect_wrapper_name) (ValaCCodeBaseModule* self, ValaDynamicSignal* node);
	void (*generate_marshaller) (ValaCCodeBaseModule* self, ValaList* params, ValaDataType* return_type, gboolean dbus);
	char* (*get_marshaller_function) (ValaCCodeBaseModule* self, ValaList* params, ValaDataType* return_type, const char* prefix, gboolean dbus);
	char* (*get_array_length_cname) (ValaCCodeBaseModule* self, const char* array_cname, gint dim);
	char* (*get_parameter_array_length_cname) (ValaCCodeBaseModule* self, ValaFormalParameter* param, gint dim);
	ValaCCodeExpression* (*get_array_length_cexpression) (ValaCCodeBaseModule* self, ValaExpression* array_expr, gint dim);
	char* (*get_array_size_cname) (ValaCCodeBaseModule* self, const char* array_cname);
	ValaCCodeExpression* (*get_array_size_cexpression) (ValaCCodeBaseModule* self, ValaExpression* array_expr);
	void (*add_simple_check) (ValaCCodeBaseModule* self, ValaCodeNode* node, ValaCCodeFragment* cfrag, gboolean always_fails);
};

struct _ValaCCodeStructModule {
	ValaCCodeBaseModule parent_instance;
	ValaCCodeStructModulePrivate * priv;
};

struct _ValaCCodeStructModuleClass {
	ValaCCodeBaseModuleClass parent_class;
};


static gpointer vala_ccode_struct_module_parent_class = NULL;

GType vala_ccode_base_module_get_type (void) G_GNUC_CONST;
gpointer vala_ccode_declaration_space_ref (gpointer instance);
void vala_ccode_declaration_space_unref (gpointer instance);
GParamSpec* vala_param_spec_ccode_declaration_space (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void vala_value_set_ccode_declaration_space (GValue* value, gpointer v_object);
void vala_value_take_ccode_declaration_space (GValue* value, gpointer v_object);
gpointer vala_value_get_ccode_declaration_space (const GValue* value);
GType vala_ccode_declaration_space_get_type (void) G_GNUC_CONST;
gpointer vala_ccode_base_module_emit_context_ref (gpointer instance);
void vala_ccode_base_module_emit_context_unref (gpointer instance);
GParamSpec* vala_ccode_base_module_param_spec_emit_context (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void vala_ccode_base_module_value_set_emit_context (GValue* value, gpointer v_object);
void vala_ccode_base_module_value_take_emit_context (GValue* value, gpointer v_object);
gpointer vala_ccode_base_module_value_get_emit_context (const GValue* value);
GType vala_ccode_base_module_emit_context_get_type (void) G_GNUC_CONST;
GType vala_ccode_struct_module_get_type (void) G_GNUC_CONST;
enum  {
	VALA_CCODE_STRUCT_MODULE_DUMMY_PROPERTY
};
static void vala_ccode_struct_module_real_generate_struct_declaration (ValaCCodeBaseModule* base, ValaStruct* st, ValaCCodeDeclarationSpace* decl_space);
gboolean vala_ccode_declaration_space_add_symbol_declaration (ValaCCodeDeclarationSpace* self, ValaSymbol* sym, const char* name);
void vala_ccode_declaration_space_add_include (ValaCCodeDeclarationSpace* self, const char* filename, gboolean local);
ValaCodeContext* vala_ccode_base_module_get_context (ValaCCodeBaseModule* self);
void vala_ccode_declaration_space_add_type_declaration (ValaCCodeDeclarationSpace* self, ValaCCodeNode* node);
ValaStructRegisterFunction* vala_struct_register_function_new (ValaStruct* st, ValaCodeContext* context);
ValaStructRegisterFunction* vala_struct_register_function_construct (GType object_type, ValaStruct* st, ValaCodeContext* context);
gpointer vala_typeregister_function_ref (gpointer instance);
void vala_typeregister_function_unref (gpointer instance);
GParamSpec* vala_param_spec_typeregister_function (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void vala_value_set_typeregister_function (GValue* value, gpointer v_object);
void vala_value_take_typeregister_function (GValue* value, gpointer v_object);
gpointer vala_value_get_typeregister_function (const GValue* value);
GType vala_typeregister_function_get_type (void) G_GNUC_CONST;
GType vala_struct_register_function_get_type (void) G_GNUC_CONST;
void vala_typeregister_function_init_from_type (ValaTypeRegisterFunction* self, gboolean plugin);
void vala_ccode_declaration_space_add_type_member_declaration (ValaCCodeDeclarationSpace* self, ValaCCodeNode* node);
ValaCCodeFragment* vala_typeregister_function_get_declaration (ValaTypeRegisterFunction* self);
void vala_ccode_base_module_generate_type_declaration (ValaCCodeBaseModule* self, ValaDataType* type, ValaCCodeDeclarationSpace* decl_space);
char* vala_ccode_base_module_get_array_length_cname (ValaCCodeBaseModule* self, const char* array_cname, gint dim);
char* vala_ccode_base_module_get_array_size_cname (ValaCCodeBaseModule* self, const char* array_cname);
char* vala_ccode_base_module_get_delegate_target_cname (ValaCCodeBaseModule* self, const char* delegate_cname);
char* vala_ccode_base_module_get_delegate_target_destroy_notify_cname (ValaCCodeBaseModule* self, const char* delegate_cname);
void vala_ccode_declaration_space_add_type_definition (ValaCCodeDeclarationSpace* self, ValaCCodeNode* node);
static void vala_ccode_struct_module_real_visit_struct (ValaCodeVisitor* base, ValaStruct* st);
void vala_ccode_base_module_push_context (ValaCCodeBaseModule* self, ValaCCodeBaseModuleEmitContext* emit_context);
ValaCCodeBaseModuleEmitContext* vala_ccode_base_module_emit_context_new (ValaSymbol* symbol);
ValaCCodeBaseModuleEmitContext* vala_ccode_base_module_emit_context_construct (GType object_type, ValaSymbol* symbol);
void vala_ccode_base_module_generate_struct_declaration (ValaCCodeBaseModule* self, ValaStruct* st, ValaCCodeDeclarationSpace* decl_space);
static void vala_ccode_struct_module_add_struct_copy_function (ValaCCodeStructModule* self, ValaStruct* st);
static void vala_ccode_struct_module_add_struct_destroy_function (ValaCCodeStructModule* self, ValaStruct* st);
static void vala_ccode_struct_module_add_struct_dup_function (ValaCCodeStructModule* self, ValaStruct* st);
static void vala_ccode_struct_module_add_struct_free_function (ValaCCodeStructModule* self, ValaStruct* st);
void vala_ccode_base_module_pop_context (ValaCCodeBaseModule* self);
gboolean vala_ccode_base_module_requires_copy (ValaCCodeBaseModule* self, ValaDataType* type);
ValaDataType* vala_ccode_base_module_get_data_type_for_symbol (ValaTypeSymbol* sym);
ValaCCodeExpression* vala_ccode_base_module_get_ref_cexpression (ValaCCodeBaseModule* self, ValaDataType* expression_type, ValaCCodeExpression* cexpr, ValaExpression* expr, ValaCodeNode* node);
void vala_ccode_base_module_append_temp_decl (ValaCCodeBaseModule* self, ValaCCodeFragment* cfrag, ValaList* temp_vars);
ValaArrayList* vala_ccode_base_module_get_temp_vars (ValaCCodeBaseModule* self);
ValaCCodeStructModule* vala_ccode_struct_module_new (void);
ValaCCodeStructModule* vala_ccode_struct_module_construct (GType object_type);
ValaCCodeBaseModule* vala_ccode_base_module_new (void);
ValaCCodeBaseModule* vala_ccode_base_module_construct (GType object_type);



static gpointer _vala_code_node_ref0 (gpointer self) {
	return self ? vala_code_node_ref (self) : NULL;
}


static void vala_ccode_struct_module_real_generate_struct_declaration (ValaCCodeBaseModule* base, ValaStruct* st, ValaCCodeDeclarationSpace* decl_space) {
	ValaCCodeStructModule * self;
	char* _tmp0_;
	gboolean _tmp1_;
	char* _tmp11_;
	char* _tmp12_;
	ValaCCodeStruct* _tmp13_;
	ValaCCodeStruct* instance_struct;
	char* _tmp39_;
	char* _tmp40_;
	char* _tmp41_;
	ValaCCodeFunction* _tmp42_;
	ValaCCodeFunction* function;
	char* _tmp43_;
	char* _tmp44_;
	char* _tmp45_;
	ValaCCodeFormalParameter* _tmp46_;
	char* _tmp47_;
	ValaCCodeFunction* _tmp48_;
	char* _tmp49_;
	char* _tmp50_;
	ValaCCodeFormalParameter* _tmp51_;
	self = (ValaCCodeStructModule*) base;
	g_return_if_fail (st != NULL);
	g_return_if_fail (decl_space != NULL);
	if ((_tmp1_ = vala_ccode_declaration_space_add_symbol_declaration (decl_space, (ValaSymbol*) st, _tmp0_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE)), _g_free0 (_tmp0_), _tmp1_)) {
		return;
	}
	if (vala_struct_is_boolean_type (st)) {
		vala_ccode_declaration_space_add_include (decl_space, "stdbool.h", FALSE);
		vala_struct_set_cname (st, "bool");
		return;
	} else {
		if (vala_struct_is_integer_type (st)) {
			const char* _tmp2_;
			char* _tmp3_;
			vala_ccode_declaration_space_add_include (decl_space, "stdint.h", FALSE);
			_tmp2_ = NULL;
			if (vala_struct_get_signed (st)) {
				_tmp2_ = "";
			} else {
				_tmp2_ = "u";
			}
			vala_struct_set_cname (st, _tmp3_ = g_strdup_printf ("%sint%d_t", _tmp2_, vala_struct_get_width (st)));
			_g_free0 (_tmp3_);
			return;
		} else {
			if (vala_struct_is_floating_type (st)) {
				const char* _tmp4_;
				_tmp4_ = NULL;
				if (vala_struct_get_width (st) == 64) {
					_tmp4_ = "double";
				} else {
					_tmp4_ = "float";
				}
				vala_struct_set_cname (st, _tmp4_);
				return;
			}
		}
	}
	if (vala_code_context_get_profile (vala_ccode_base_module_get_context ((ValaCCodeBaseModule*) self)) == VALA_PROFILE_GOBJECT) {
		if (vala_struct_get_has_type_id (st)) {
			ValaCCodeNewline* _tmp5_;
			char* _tmp6_;
			char* _tmp7_;
			char* macro;
			char* _tmp8_;
			ValaCCodeMacroReplacement* _tmp9_;
			ValaStructRegisterFunction* type_fun;
			ValaCCodeFragment* _tmp10_;
			vala_ccode_declaration_space_add_type_declaration (decl_space, (ValaCCodeNode*) (_tmp5_ = vala_ccode_newline_new ()));
			_vala_ccode_node_unref0 (_tmp5_);
			macro = (_tmp7_ = g_strdup_printf ("(%s_get_type ())", _tmp6_ = vala_symbol_get_lower_case_cname ((ValaSymbol*) st, NULL)), _g_free0 (_tmp6_), _tmp7_);
			vala_ccode_declaration_space_add_type_declaration (decl_space, (ValaCCodeNode*) (_tmp9_ = vala_ccode_macro_replacement_new (_tmp8_ = vala_typesymbol_get_type_id ((ValaTypeSymbol*) st), macro)));
			_vala_ccode_node_unref0 (_tmp9_);
			_g_free0 (_tmp8_);
			type_fun = vala_struct_register_function_new (st, vala_ccode_base_module_get_context ((ValaCCodeBaseModule*) self));
			vala_typeregister_function_init_from_type ((ValaTypeRegisterFunction*) type_fun, FALSE);
			vala_ccode_declaration_space_add_type_member_declaration (decl_space, (ValaCCodeNode*) (_tmp10_ = vala_typeregister_function_get_declaration ((ValaTypeRegisterFunction*) type_fun)));
			_vala_ccode_node_unref0 (_tmp10_);
			_vala_typeregister_function_unref0 (type_fun);
			_g_free0 (macro);
		}
	}
	instance_struct = (_tmp13_ = vala_ccode_struct_new (_tmp12_ = g_strdup_printf ("_%s", _tmp11_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE))), _g_free0 (_tmp12_), _g_free0 (_tmp11_), _tmp13_);
	vala_ccode_struct_set_deprecated (instance_struct, vala_symbol_get_deprecated ((ValaSymbol*) st));
	{
		ValaList* _tmp14_;
		ValaIterator* _tmp15_;
		ValaIterator* _f_it;
		_f_it = (_tmp15_ = vala_iterable_iterator ((ValaIterable*) (_tmp14_ = vala_struct_get_fields (st))), _vala_collection_object_unref0 (_tmp14_), _tmp15_);
		while (TRUE) {
			ValaField* f;
			char* field_ctype;
			if (!vala_iterator_next (_f_it)) {
				break;
			}
			f = (ValaField*) vala_iterator_get (_f_it);
			field_ctype = vala_data_type_get_cname (vala_variable_get_variable_type ((ValaVariable*) f));
			if (vala_field_get_is_volatile (f)) {
				char* _tmp16_;
				field_ctype = (_tmp16_ = g_strconcat ("volatile ", field_ctype, NULL), _g_free0 (field_ctype), _tmp16_);
			}
			if (vala_field_get_binding (f) == MEMBER_BINDING_INSTANCE) {
				const char* _tmp17_;
				char* _tmp18_;
				char* _tmp19_;
				char* _tmp20_;
				gboolean _tmp21_ = FALSE;
				vala_ccode_base_module_generate_type_declaration ((ValaCCodeBaseModule*) self, vala_variable_get_variable_type ((ValaVariable*) f), decl_space);
				_tmp17_ = NULL;
				if (vala_symbol_get_deprecated ((ValaSymbol*) f)) {
					_tmp17_ = " G_GNUC_DEPRECATED";
				} else {
					_tmp17_ = NULL;
				}
				vala_ccode_struct_add_field (instance_struct, field_ctype, _tmp20_ = g_strconcat (_tmp18_ = vala_field_get_cname (f), _tmp19_ = vala_data_type_get_cdeclarator_suffix (vala_variable_get_variable_type ((ValaVariable*) f)), NULL), _tmp17_);
				_g_free0 (_tmp20_);
				_g_free0 (_tmp19_);
				_g_free0 (_tmp18_);
				if (VALA_IS_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) f))) {
					_tmp21_ = !vala_field_get_no_array_length (f);
				} else {
					_tmp21_ = FALSE;
				}
				if (_tmp21_) {
					ValaArrayType* array_type;
					array_type = _vala_code_node_ref0 (VALA_ARRAY_TYPE (vala_variable_get_variable_type ((ValaVariable*) f)));
					if (!vala_array_type_get_fixed_length (array_type)) {
						ValaDataType* len_type;
						gboolean _tmp25_ = FALSE;
						len_type = vala_data_type_copy (((ValaCCodeBaseModule*) self)->int_type);
						{
							gint dim;
							dim = 1;
							{
								gboolean _tmp22_;
								_tmp22_ = TRUE;
								while (TRUE) {
									char* _tmp23_;
									char* _tmp24_;
									if (!_tmp22_) {
										dim++;
									}
									_tmp22_ = FALSE;
									if (!(dim <= vala_array_type_get_rank (array_type))) {
										break;
									}
									vala_ccode_struct_add_field (instance_struct, _tmp23_ = vala_data_type_get_cname (len_type), _tmp24_ = vala_ccode_base_module_get_array_length_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) f), dim), NULL);
									_g_free0 (_tmp24_);
									_g_free0 (_tmp23_);
								}
							}
						}
						if (vala_array_type_get_rank (array_type) == 1) {
							_tmp25_ = vala_symbol_is_internal_symbol ((ValaSymbol*) f);
						} else {
							_tmp25_ = FALSE;
						}
						if (_tmp25_) {
							char* _tmp26_;
							char* _tmp27_;
							vala_ccode_struct_add_field (instance_struct, _tmp26_ = vala_data_type_get_cname (len_type), _tmp27_ = vala_ccode_base_module_get_array_size_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) f)), NULL);
							_g_free0 (_tmp27_);
							_g_free0 (_tmp26_);
						}
						_vala_code_node_unref0 (len_type);
					}
					_vala_code_node_unref0 (array_type);
				} else {
					if (VALA_IS_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) f))) {
						ValaDelegateType* delegate_type;
						delegate_type = _vala_code_node_ref0 (VALA_DELEGATE_TYPE (vala_variable_get_variable_type ((ValaVariable*) f)));
						if (vala_delegate_get_has_target (vala_delegate_type_get_delegate_symbol (delegate_type))) {
							char* _tmp28_;
							vala_ccode_struct_add_field (instance_struct, "gpointer", _tmp28_ = vala_ccode_base_module_get_delegate_target_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) f)), NULL);
							_g_free0 (_tmp28_);
							if (vala_data_type_get_value_owned ((ValaDataType*) delegate_type)) {
								char* _tmp29_;
								vala_ccode_struct_add_field (instance_struct, "GDestroyNotify", _tmp29_ = vala_ccode_base_module_get_delegate_target_destroy_notify_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) f)), NULL);
								_g_free0 (_tmp29_);
							}
						}
						_vala_code_node_unref0 (delegate_type);
					}
				}
			}
			_g_free0 (field_ctype);
			_vala_code_node_unref0 (f);
		}
		_vala_collection_object_unref0 (_f_it);
	}
	if (vala_struct_get_base_struct (st) == NULL) {
		char* _tmp30_;
		char* _tmp31_;
		char* _tmp32_;
		ValaCCodeVariableDeclarator* _tmp33_;
		ValaCCodeTypeDefinition* _tmp34_;
		vala_ccode_declaration_space_add_type_declaration (decl_space, (ValaCCodeNode*) (_tmp34_ = vala_ccode_type_definition_new (_tmp31_ = g_strdup_printf ("struct _%s", _tmp30_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE)), (ValaCCodeDeclarator*) (_tmp33_ = vala_ccode_variable_declarator_new (_tmp32_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), NULL, NULL)))));
		_vala_ccode_node_unref0 (_tmp34_);
		_vala_ccode_node_unref0 (_tmp33_);
		_g_free0 (_tmp32_);
		_g_free0 (_tmp31_);
		_g_free0 (_tmp30_);
		vala_ccode_declaration_space_add_type_definition (decl_space, (ValaCCodeNode*) instance_struct);
	} else {
		char* _tmp35_;
		char* _tmp36_;
		ValaCCodeVariableDeclarator* _tmp37_;
		ValaCCodeTypeDefinition* _tmp38_;
		vala_ccode_declaration_space_add_type_declaration (decl_space, (ValaCCodeNode*) (_tmp38_ = vala_ccode_type_definition_new (_tmp35_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) vala_struct_get_base_struct (st), FALSE), (ValaCCodeDeclarator*) (_tmp37_ = vala_ccode_variable_declarator_new (_tmp36_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), NULL, NULL)))));
		_vala_ccode_node_unref0 (_tmp38_);
		_vala_ccode_node_unref0 (_tmp37_);
		_g_free0 (_tmp36_);
		_g_free0 (_tmp35_);
	}
	function = (_tmp42_ = vala_ccode_function_new (_tmp39_ = vala_typesymbol_get_dup_function ((ValaTypeSymbol*) st), _tmp41_ = g_strconcat (_tmp40_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)), _g_free0 (_tmp41_), _g_free0 (_tmp40_), _g_free0 (_tmp39_), _tmp42_);
	if (vala_symbol_is_private_symbol ((ValaSymbol*) st)) {
		vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	}
	vala_ccode_function_add_parameter (function, _tmp46_ = vala_ccode_formal_parameter_new ("self", _tmp45_ = g_strconcat (_tmp44_ = g_strconcat ("const ", _tmp43_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), NULL), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp46_);
	_g_free0 (_tmp45_);
	_g_free0 (_tmp44_);
	_g_free0 (_tmp43_);
	vala_ccode_declaration_space_add_type_member_declaration (decl_space, (ValaCCodeNode*) function);
	function = (_tmp48_ = vala_ccode_function_new (_tmp47_ = vala_typesymbol_get_free_function ((ValaTypeSymbol*) st), "void"), _vala_ccode_node_unref0 (function), _tmp48_);
	_g_free0 (_tmp47_);
	if (vala_symbol_is_private_symbol ((ValaSymbol*) st)) {
		vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	}
	vala_ccode_function_add_parameter (function, _tmp51_ = vala_ccode_formal_parameter_new ("self", _tmp50_ = g_strconcat (_tmp49_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp51_);
	_g_free0 (_tmp50_);
	_g_free0 (_tmp49_);
	vala_ccode_declaration_space_add_type_member_declaration (decl_space, (ValaCCodeNode*) function);
	if (vala_struct_is_disposable (st)) {
		char* _tmp52_;
		ValaCCodeFunction* _tmp53_;
		char* _tmp54_;
		char* _tmp55_;
		char* _tmp56_;
		ValaCCodeFormalParameter* _tmp57_;
		char* _tmp58_;
		char* _tmp59_;
		ValaCCodeFormalParameter* _tmp60_;
		char* _tmp61_;
		ValaCCodeFunction* _tmp62_;
		char* _tmp63_;
		char* _tmp64_;
		ValaCCodeFormalParameter* _tmp65_;
		function = (_tmp53_ = vala_ccode_function_new (_tmp52_ = vala_typesymbol_get_copy_function ((ValaTypeSymbol*) st), "void"), _vala_ccode_node_unref0 (function), _tmp53_);
		_g_free0 (_tmp52_);
		if (vala_symbol_is_private_symbol ((ValaSymbol*) st)) {
			vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
		}
		vala_ccode_function_add_parameter (function, _tmp57_ = vala_ccode_formal_parameter_new ("self", _tmp56_ = g_strconcat (_tmp55_ = g_strconcat ("const ", _tmp54_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), NULL), "*", NULL)));
		_vala_ccode_node_unref0 (_tmp57_);
		_g_free0 (_tmp56_);
		_g_free0 (_tmp55_);
		_g_free0 (_tmp54_);
		vala_ccode_function_add_parameter (function, _tmp60_ = vala_ccode_formal_parameter_new ("dest", _tmp59_ = g_strconcat (_tmp58_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)));
		_vala_ccode_node_unref0 (_tmp60_);
		_g_free0 (_tmp59_);
		_g_free0 (_tmp58_);
		vala_ccode_declaration_space_add_type_member_declaration (decl_space, (ValaCCodeNode*) function);
		function = (_tmp62_ = vala_ccode_function_new (_tmp61_ = vala_typesymbol_get_destroy_function ((ValaTypeSymbol*) st), "void"), _vala_ccode_node_unref0 (function), _tmp62_);
		_g_free0 (_tmp61_);
		if (vala_symbol_is_private_symbol ((ValaSymbol*) st)) {
			vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
		}
		vala_ccode_function_add_parameter (function, _tmp65_ = vala_ccode_formal_parameter_new ("self", _tmp64_ = g_strconcat (_tmp63_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)));
		_vala_ccode_node_unref0 (_tmp65_);
		_g_free0 (_tmp64_);
		_g_free0 (_tmp63_);
		vala_ccode_declaration_space_add_type_member_declaration (decl_space, (ValaCCodeNode*) function);
	}
	_vala_ccode_node_unref0 (function);
	_vala_ccode_node_unref0 (instance_struct);
}


static gpointer _vala_ccode_node_ref0 (gpointer self) {
	return self ? vala_ccode_node_ref (self) : NULL;
}


static void vala_ccode_struct_module_real_visit_struct (ValaCodeVisitor* base, ValaStruct* st) {
	ValaCCodeStructModule * self;
	ValaCCodeBaseModuleEmitContext* _tmp0_;
	ValaCCodeFragment* old_instance_finalize_fragment;
	ValaCCodeFragment* _tmp1_;
	gboolean _tmp2_ = FALSE;
	gboolean _tmp3_ = FALSE;
	gboolean _tmp4_ = FALSE;
	ValaCCodeFragment* _tmp5_;
	self = (ValaCCodeStructModule*) base;
	g_return_if_fail (st != NULL);
	vala_ccode_base_module_push_context ((ValaCCodeBaseModule*) self, _tmp0_ = vala_ccode_base_module_emit_context_new ((ValaSymbol*) st));
	_vala_ccode_base_module_emit_context_unref0 (_tmp0_);
	old_instance_finalize_fragment = _vala_ccode_node_ref0 (((ValaCCodeBaseModule*) self)->instance_finalize_fragment);
	((ValaCCodeBaseModule*) self)->instance_finalize_fragment = (_tmp1_ = vala_ccode_fragment_new (), _vala_ccode_node_unref0 (((ValaCCodeBaseModule*) self)->instance_finalize_fragment), _tmp1_);
	vala_ccode_base_module_generate_struct_declaration ((ValaCCodeBaseModule*) self, st, ((ValaCCodeBaseModule*) self)->source_declarations);
	if (!vala_symbol_is_internal_symbol ((ValaSymbol*) st)) {
		vala_ccode_base_module_generate_struct_declaration ((ValaCCodeBaseModule*) self, st, ((ValaCCodeBaseModule*) self)->header_declarations);
	}
	if (!vala_symbol_is_private_symbol ((ValaSymbol*) st)) {
		vala_ccode_base_module_generate_struct_declaration ((ValaCCodeBaseModule*) self, st, ((ValaCCodeBaseModule*) self)->internal_header_declarations);
	}
	vala_code_node_accept_children ((ValaCodeNode*) st, (ValaCodeVisitor*) self);
	if (vala_code_context_get_profile (vala_ccode_base_module_get_context ((ValaCCodeBaseModule*) self)) == VALA_PROFILE_GOBJECT) {
		_tmp4_ = !vala_struct_is_boolean_type (st);
	} else {
		_tmp4_ = FALSE;
	}
	if (_tmp4_) {
		_tmp3_ = !vala_struct_is_integer_type (st);
	} else {
		_tmp3_ = FALSE;
	}
	if (_tmp3_) {
		_tmp2_ = !vala_struct_is_floating_type (st);
	} else {
		_tmp2_ = FALSE;
	}
	if (_tmp2_) {
		if (vala_struct_is_disposable (st)) {
			vala_ccode_struct_module_add_struct_copy_function (self, st);
			vala_ccode_struct_module_add_struct_destroy_function (self, st);
		}
		vala_ccode_struct_module_add_struct_dup_function (self, st);
		vala_ccode_struct_module_add_struct_free_function (self, st);
	}
	((ValaCCodeBaseModule*) self)->instance_finalize_fragment = (_tmp5_ = _vala_ccode_node_ref0 (old_instance_finalize_fragment), _vala_ccode_node_unref0 (((ValaCCodeBaseModule*) self)->instance_finalize_fragment), _tmp5_);
	vala_ccode_base_module_pop_context ((ValaCCodeBaseModule*) self);
	_vala_ccode_node_unref0 (old_instance_finalize_fragment);
}


static void vala_ccode_struct_module_add_struct_dup_function (ValaCCodeStructModule* self, ValaStruct* st) {
	char* _tmp0_;
	char* _tmp1_;
	char* _tmp2_;
	ValaCCodeFunction* _tmp3_;
	ValaCCodeFunction* function;
	char* _tmp4_;
	char* _tmp5_;
	char* _tmp6_;
	ValaCCodeFormalParameter* _tmp7_;
	ValaCCodeBlock* cblock;
	char* _tmp8_;
	char* _tmp9_;
	ValaCCodeDeclaration* _tmp10_;
	ValaCCodeDeclaration* _cdecl_;
	ValaCCodeVariableDeclarator* _tmp11_;
	ValaCCodeIdentifier* _tmp12_;
	ValaCCodeFunctionCall* _tmp13_;
	ValaCCodeFunctionCall* creation_call;
	char* _tmp14_;
	ValaCCodeConstant* _tmp15_;
	ValaCCodeConstant* _tmp16_;
	ValaCCodeIdentifier* _tmp17_;
	ValaCCodeAssignment* _tmp18_;
	ValaCCodeExpressionStatement* _tmp19_;
	ValaCCodeIdentifier* _tmp35_;
	ValaCCodeReturnStatement* _tmp36_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (st != NULL);
	function = (_tmp3_ = vala_ccode_function_new (_tmp0_ = vala_typesymbol_get_dup_function ((ValaTypeSymbol*) st), _tmp2_ = g_strconcat (_tmp1_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)), _g_free0 (_tmp2_), _g_free0 (_tmp1_), _g_free0 (_tmp0_), _tmp3_);
	if (vala_symbol_get_access ((ValaSymbol*) st) == VALA_SYMBOL_ACCESSIBILITY_PRIVATE) {
		vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	}
	vala_ccode_function_add_parameter (function, _tmp7_ = vala_ccode_formal_parameter_new ("self", _tmp6_ = g_strconcat (_tmp5_ = g_strconcat ("const ", _tmp4_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), NULL), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp7_);
	_g_free0 (_tmp6_);
	_g_free0 (_tmp5_);
	_g_free0 (_tmp4_);
	cblock = vala_ccode_block_new ();
	_cdecl_ = (_tmp10_ = vala_ccode_declaration_new (_tmp9_ = g_strconcat (_tmp8_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)), _g_free0 (_tmp9_), _g_free0 (_tmp8_), _tmp10_);
	vala_ccode_declaration_add_declarator (_cdecl_, (ValaCCodeDeclarator*) (_tmp11_ = vala_ccode_variable_declarator_new ("dup", NULL, NULL)));
	_vala_ccode_node_unref0 (_tmp11_);
	vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) _cdecl_);
	creation_call = (_tmp13_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp12_ = vala_ccode_identifier_new ("g_new0"))), _vala_ccode_node_unref0 (_tmp12_), _tmp13_);
	vala_ccode_function_call_add_argument (creation_call, (ValaCCodeExpression*) (_tmp15_ = vala_ccode_constant_new (_tmp14_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE))));
	_vala_ccode_node_unref0 (_tmp15_);
	_g_free0 (_tmp14_);
	vala_ccode_function_call_add_argument (creation_call, (ValaCCodeExpression*) (_tmp16_ = vala_ccode_constant_new ("1")));
	_vala_ccode_node_unref0 (_tmp16_);
	vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp19_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) (_tmp18_ = vala_ccode_assignment_new ((ValaCCodeExpression*) (_tmp17_ = vala_ccode_identifier_new ("dup")), (ValaCCodeExpression*) creation_call, VALA_CCODE_ASSIGNMENT_OPERATOR_SIMPLE)))));
	_vala_ccode_node_unref0 (_tmp19_);
	_vala_ccode_node_unref0 (_tmp18_);
	_vala_ccode_node_unref0 (_tmp17_);
	if (vala_struct_is_disposable (st)) {
		char* _tmp20_;
		ValaCCodeIdentifier* _tmp21_;
		ValaCCodeFunctionCall* _tmp22_;
		ValaCCodeFunctionCall* copy_call;
		ValaCCodeIdentifier* _tmp23_;
		ValaCCodeIdentifier* _tmp24_;
		ValaCCodeExpressionStatement* _tmp25_;
		copy_call = (_tmp22_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp21_ = vala_ccode_identifier_new (_tmp20_ = vala_typesymbol_get_copy_function ((ValaTypeSymbol*) st)))), _vala_ccode_node_unref0 (_tmp21_), _g_free0 (_tmp20_), _tmp22_);
		vala_ccode_function_call_add_argument (copy_call, (ValaCCodeExpression*) (_tmp23_ = vala_ccode_identifier_new ("self")));
		_vala_ccode_node_unref0 (_tmp23_);
		vala_ccode_function_call_add_argument (copy_call, (ValaCCodeExpression*) (_tmp24_ = vala_ccode_identifier_new ("dup")));
		_vala_ccode_node_unref0 (_tmp24_);
		vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp25_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) copy_call)));
		_vala_ccode_node_unref0 (_tmp25_);
		_vala_ccode_node_unref0 (copy_call);
	} else {
		ValaCCodeIdentifier* _tmp26_;
		ValaCCodeFunctionCall* _tmp27_;
		ValaCCodeFunctionCall* sizeof_call;
		char* _tmp28_;
		ValaCCodeConstant* _tmp29_;
		ValaCCodeIdentifier* _tmp30_;
		ValaCCodeFunctionCall* _tmp31_;
		ValaCCodeFunctionCall* copy_call;
		ValaCCodeIdentifier* _tmp32_;
		ValaCCodeIdentifier* _tmp33_;
		ValaCCodeExpressionStatement* _tmp34_;
		vala_ccode_declaration_space_add_include (((ValaCCodeBaseModule*) self)->source_declarations, "string.h", FALSE);
		sizeof_call = (_tmp27_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp26_ = vala_ccode_identifier_new ("sizeof"))), _vala_ccode_node_unref0 (_tmp26_), _tmp27_);
		vala_ccode_function_call_add_argument (sizeof_call, (ValaCCodeExpression*) (_tmp29_ = vala_ccode_constant_new (_tmp28_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE))));
		_vala_ccode_node_unref0 (_tmp29_);
		_g_free0 (_tmp28_);
		copy_call = (_tmp31_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp30_ = vala_ccode_identifier_new ("memcpy"))), _vala_ccode_node_unref0 (_tmp30_), _tmp31_);
		vala_ccode_function_call_add_argument (copy_call, (ValaCCodeExpression*) (_tmp32_ = vala_ccode_identifier_new ("dup")));
		_vala_ccode_node_unref0 (_tmp32_);
		vala_ccode_function_call_add_argument (copy_call, (ValaCCodeExpression*) (_tmp33_ = vala_ccode_identifier_new ("self")));
		_vala_ccode_node_unref0 (_tmp33_);
		vala_ccode_function_call_add_argument (copy_call, (ValaCCodeExpression*) sizeof_call);
		vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp34_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) copy_call)));
		_vala_ccode_node_unref0 (_tmp34_);
		_vala_ccode_node_unref0 (copy_call);
		_vala_ccode_node_unref0 (sizeof_call);
	}
	vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp36_ = vala_ccode_return_statement_new ((ValaCCodeExpression*) (_tmp35_ = vala_ccode_identifier_new ("dup")))));
	_vala_ccode_node_unref0 (_tmp36_);
	_vala_ccode_node_unref0 (_tmp35_);
	vala_ccode_function_set_block (function, cblock);
	vala_ccode_fragment_append (((ValaCCodeBaseModule*) self)->source_type_member_definition, (ValaCCodeNode*) function);
	_vala_ccode_node_unref0 (creation_call);
	_vala_ccode_node_unref0 (_cdecl_);
	_vala_ccode_node_unref0 (cblock);
	_vala_ccode_node_unref0 (function);
}


static void vala_ccode_struct_module_add_struct_free_function (ValaCCodeStructModule* self, ValaStruct* st) {
	char* _tmp0_;
	ValaCCodeFunction* _tmp1_;
	ValaCCodeFunction* function;
	char* _tmp2_;
	char* _tmp3_;
	ValaCCodeFormalParameter* _tmp4_;
	ValaCCodeBlock* cblock;
	ValaCCodeIdentifier* _tmp10_;
	ValaCCodeFunctionCall* _tmp11_;
	ValaCCodeFunctionCall* free_call;
	ValaCCodeIdentifier* _tmp12_;
	ValaCCodeExpressionStatement* _tmp13_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (st != NULL);
	function = (_tmp1_ = vala_ccode_function_new (_tmp0_ = vala_typesymbol_get_free_function ((ValaTypeSymbol*) st), "void"), _g_free0 (_tmp0_), _tmp1_);
	if (vala_symbol_get_access ((ValaSymbol*) st) == VALA_SYMBOL_ACCESSIBILITY_PRIVATE) {
		vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	}
	vala_ccode_function_add_parameter (function, _tmp4_ = vala_ccode_formal_parameter_new ("self", _tmp3_ = g_strconcat (_tmp2_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp4_);
	_g_free0 (_tmp3_);
	_g_free0 (_tmp2_);
	cblock = vala_ccode_block_new ();
	if (vala_struct_is_disposable (st)) {
		char* _tmp5_;
		ValaCCodeIdentifier* _tmp6_;
		ValaCCodeFunctionCall* _tmp7_;
		ValaCCodeFunctionCall* destroy_call;
		ValaCCodeIdentifier* _tmp8_;
		ValaCCodeExpressionStatement* _tmp9_;
		destroy_call = (_tmp7_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp6_ = vala_ccode_identifier_new (_tmp5_ = vala_typesymbol_get_destroy_function ((ValaTypeSymbol*) st)))), _vala_ccode_node_unref0 (_tmp6_), _g_free0 (_tmp5_), _tmp7_);
		vala_ccode_function_call_add_argument (destroy_call, (ValaCCodeExpression*) (_tmp8_ = vala_ccode_identifier_new ("self")));
		_vala_ccode_node_unref0 (_tmp8_);
		vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp9_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) destroy_call)));
		_vala_ccode_node_unref0 (_tmp9_);
		_vala_ccode_node_unref0 (destroy_call);
	}
	free_call = (_tmp11_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp10_ = vala_ccode_identifier_new ("g_free"))), _vala_ccode_node_unref0 (_tmp10_), _tmp11_);
	vala_ccode_function_call_add_argument (free_call, (ValaCCodeExpression*) (_tmp12_ = vala_ccode_identifier_new ("self")));
	_vala_ccode_node_unref0 (_tmp12_);
	vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp13_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) free_call)));
	_vala_ccode_node_unref0 (_tmp13_);
	vala_ccode_function_set_block (function, cblock);
	vala_ccode_fragment_append (((ValaCCodeBaseModule*) self)->source_type_member_definition, (ValaCCodeNode*) function);
	_vala_ccode_node_unref0 (free_call);
	_vala_ccode_node_unref0 (cblock);
	_vala_ccode_node_unref0 (function);
}


static void vala_ccode_struct_module_add_struct_copy_function (ValaCCodeStructModule* self, ValaStruct* st) {
	char* _tmp0_;
	ValaCCodeFunction* _tmp1_;
	ValaCCodeFunction* function;
	char* _tmp2_;
	char* _tmp3_;
	char* _tmp4_;
	ValaCCodeFormalParameter* _tmp5_;
	char* _tmp6_;
	char* _tmp7_;
	ValaCCodeFormalParameter* _tmp8_;
	ValaCCodeBlock* cblock;
	ValaCCodeFragment* cfrag;
	g_return_if_fail (self != NULL);
	g_return_if_fail (st != NULL);
	function = (_tmp1_ = vala_ccode_function_new (_tmp0_ = vala_typesymbol_get_copy_function ((ValaTypeSymbol*) st), "void"), _g_free0 (_tmp0_), _tmp1_);
	if (vala_symbol_get_access ((ValaSymbol*) st) == VALA_SYMBOL_ACCESSIBILITY_PRIVATE) {
		vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	}
	vala_ccode_function_add_parameter (function, _tmp5_ = vala_ccode_formal_parameter_new ("self", _tmp4_ = g_strconcat (_tmp3_ = g_strconcat ("const ", _tmp2_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), NULL), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp5_);
	_g_free0 (_tmp4_);
	_g_free0 (_tmp3_);
	_g_free0 (_tmp2_);
	vala_ccode_function_add_parameter (function, _tmp8_ = vala_ccode_formal_parameter_new ("dest", _tmp7_ = g_strconcat (_tmp6_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp8_);
	_g_free0 (_tmp7_);
	_g_free0 (_tmp6_);
	cblock = vala_ccode_block_new ();
	cfrag = vala_ccode_fragment_new ();
	vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) cfrag);
	{
		ValaList* _tmp9_;
		ValaIterator* _tmp10_;
		ValaIterator* _f_it;
		_f_it = (_tmp10_ = vala_iterable_iterator ((ValaIterable*) (_tmp9_ = vala_struct_get_fields (st))), _vala_collection_object_unref0 (_tmp9_), _tmp10_);
		while (TRUE) {
			ValaField* f;
			if (!vala_iterator_next (_f_it)) {
				break;
			}
			f = (ValaField*) vala_iterator_get (_f_it);
			if (vala_field_get_binding (f) == MEMBER_BINDING_INSTANCE) {
				ValaCCodeIdentifier* _tmp11_;
				ValaCCodeExpression* _tmp12_;
				ValaCCodeExpression* copy;
				ValaCCodeIdentifier* _tmp16_;
				ValaCCodeMemberAccess* _tmp17_;
				ValaCCodeMemberAccess* dest;
				ValaDataType* _tmp18_;
				ValaArrayType* array_type;
				gboolean _tmp19_ = FALSE;
				copy = (_tmp12_ = (ValaCCodeExpression*) vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp11_ = vala_ccode_identifier_new ("self")), vala_symbol_get_name ((ValaSymbol*) f)), _vala_ccode_node_unref0 (_tmp11_), _tmp12_);
				if (vala_ccode_base_module_requires_copy ((ValaCCodeBaseModule*) self, vala_variable_get_variable_type ((ValaVariable*) f))) {
					ValaMemberAccess* this_access;
					ValaDataType* _tmp13_;
					ValaCCodeIdentifier* _tmp14_;
					ValaMemberAccess* ma;
					ValaCCodeExpression* _tmp15_;
					this_access = vala_member_access_new_simple ("this", NULL);
					vala_expression_set_value_type ((ValaExpression*) this_access, _tmp13_ = vala_ccode_base_module_get_data_type_for_symbol (VALA_TYPESYMBOL (vala_symbol_get_parent_symbol ((ValaSymbol*) f))));
					_vala_code_node_unref0 (_tmp13_);
					vala_code_node_set_ccodenode ((ValaCodeNode*) this_access, (ValaCCodeNode*) (_tmp14_ = vala_ccode_identifier_new ("(*self)")));
					_vala_ccode_node_unref0 (_tmp14_);
					ma = vala_member_access_new ((ValaExpression*) this_access, vala_symbol_get_name ((ValaSymbol*) f), NULL);
					vala_expression_set_symbol_reference ((ValaExpression*) ma, (ValaSymbol*) f);
					copy = (_tmp15_ = vala_ccode_base_module_get_ref_cexpression ((ValaCCodeBaseModule*) self, vala_variable_get_variable_type ((ValaVariable*) f), copy, (ValaExpression*) ma, (ValaCodeNode*) f), _vala_ccode_node_unref0 (copy), _tmp15_);
					if (copy == NULL) {
						_vala_code_node_unref0 (ma);
						_vala_code_node_unref0 (this_access);
						_vala_ccode_node_unref0 (copy);
						_vala_code_node_unref0 (f);
						continue;
					}
					_vala_code_node_unref0 (ma);
					_vala_code_node_unref0 (this_access);
				}
				dest = (_tmp17_ = vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp16_ = vala_ccode_identifier_new ("dest")), vala_symbol_get_name ((ValaSymbol*) f)), _vala_ccode_node_unref0 (_tmp16_), _tmp17_);
				array_type = _vala_code_node_ref0 ((_tmp18_ = vala_variable_get_variable_type ((ValaVariable*) f), VALA_IS_ARRAY_TYPE (_tmp18_) ? ((ValaArrayType*) _tmp18_) : NULL));
				if (array_type != NULL) {
					_tmp19_ = vala_array_type_get_fixed_length (array_type);
				} else {
					_tmp19_ = FALSE;
				}
				if (_tmp19_) {
					ValaCCodeIdentifier* _tmp20_;
					ValaCCodeFunctionCall* _tmp21_;
					ValaCCodeFunctionCall* sizeof_call;
					char* _tmp22_;
					ValaCCodeIdentifier* _tmp23_;
					char* _tmp24_;
					ValaCCodeConstant* _tmp25_;
					ValaCCodeBinaryExpression* _tmp26_;
					ValaCCodeBinaryExpression* size;
					ValaCCodeIdentifier* _tmp27_;
					ValaCCodeFunctionCall* _tmp28_;
					ValaCCodeFunctionCall* array_copy_call;
					ValaCCodeExpressionStatement* _tmp29_;
					vala_ccode_declaration_space_add_include (((ValaCCodeBaseModule*) self)->source_declarations, "string.h", FALSE);
					sizeof_call = (_tmp21_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp20_ = vala_ccode_identifier_new ("sizeof"))), _vala_ccode_node_unref0 (_tmp20_), _tmp21_);
					vala_ccode_function_call_add_argument (sizeof_call, (ValaCCodeExpression*) (_tmp23_ = vala_ccode_identifier_new (_tmp22_ = vala_data_type_get_cname (vala_array_type_get_element_type (array_type)))));
					_vala_ccode_node_unref0 (_tmp23_);
					_g_free0 (_tmp22_);
					size = (_tmp26_ = vala_ccode_binary_expression_new (VALA_CCODE_BINARY_OPERATOR_MUL, (ValaCCodeExpression*) (_tmp25_ = vala_ccode_constant_new (_tmp24_ = g_strdup_printf ("%d", vala_array_type_get_length (array_type)))), (ValaCCodeExpression*) sizeof_call), _vala_ccode_node_unref0 (_tmp25_), _g_free0 (_tmp24_), _tmp26_);
					array_copy_call = (_tmp28_ = vala_ccode_function_call_new ((ValaCCodeExpression*) (_tmp27_ = vala_ccode_identifier_new ("memcpy"))), _vala_ccode_node_unref0 (_tmp27_), _tmp28_);
					vala_ccode_function_call_add_argument (array_copy_call, (ValaCCodeExpression*) dest);
					vala_ccode_function_call_add_argument (array_copy_call, copy);
					vala_ccode_function_call_add_argument (array_copy_call, (ValaCCodeExpression*) size);
					vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp29_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) array_copy_call)));
					_vala_ccode_node_unref0 (_tmp29_);
					_vala_ccode_node_unref0 (array_copy_call);
					_vala_ccode_node_unref0 (size);
					_vala_ccode_node_unref0 (sizeof_call);
				} else {
					ValaCCodeAssignment* _tmp30_;
					ValaCCodeExpressionStatement* _tmp31_;
					vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp31_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) (_tmp30_ = vala_ccode_assignment_new ((ValaCCodeExpression*) dest, copy, VALA_CCODE_ASSIGNMENT_OPERATOR_SIMPLE)))));
					_vala_ccode_node_unref0 (_tmp31_);
					_vala_ccode_node_unref0 (_tmp30_);
					if (array_type != NULL) {
						{
							gint dim;
							dim = 1;
							{
								gboolean _tmp32_;
								_tmp32_ = TRUE;
								while (TRUE) {
									ValaCCodeIdentifier* _tmp33_;
									char* _tmp34_;
									ValaCCodeMemberAccess* _tmp35_;
									ValaCCodeMemberAccess* len_src;
									ValaCCodeIdentifier* _tmp36_;
									char* _tmp37_;
									ValaCCodeMemberAccess* _tmp38_;
									ValaCCodeMemberAccess* len_dest;
									ValaCCodeAssignment* _tmp39_;
									ValaCCodeExpressionStatement* _tmp40_;
									if (!_tmp32_) {
										dim++;
									}
									_tmp32_ = FALSE;
									if (!(dim <= vala_array_type_get_rank (array_type))) {
										break;
									}
									len_src = (_tmp35_ = vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp33_ = vala_ccode_identifier_new ("self")), _tmp34_ = vala_ccode_base_module_get_array_length_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) f), dim)), _g_free0 (_tmp34_), _vala_ccode_node_unref0 (_tmp33_), _tmp35_);
									len_dest = (_tmp38_ = vala_ccode_member_access_new_pointer ((ValaCCodeExpression*) (_tmp36_ = vala_ccode_identifier_new ("dest")), _tmp37_ = vala_ccode_base_module_get_array_length_cname ((ValaCCodeBaseModule*) self, vala_symbol_get_name ((ValaSymbol*) f), dim)), _g_free0 (_tmp37_), _vala_ccode_node_unref0 (_tmp36_), _tmp38_);
									vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) (_tmp40_ = vala_ccode_expression_statement_new ((ValaCCodeExpression*) (_tmp39_ = vala_ccode_assignment_new ((ValaCCodeExpression*) len_dest, (ValaCCodeExpression*) len_src, VALA_CCODE_ASSIGNMENT_OPERATOR_SIMPLE)))));
									_vala_ccode_node_unref0 (_tmp40_);
									_vala_ccode_node_unref0 (_tmp39_);
									_vala_ccode_node_unref0 (len_dest);
									_vala_ccode_node_unref0 (len_src);
								}
							}
						}
					}
				}
				_vala_code_node_unref0 (array_type);
				_vala_ccode_node_unref0 (dest);
				_vala_ccode_node_unref0 (copy);
			}
			_vala_code_node_unref0 (f);
		}
		_vala_collection_object_unref0 (_f_it);
	}
	vala_ccode_base_module_append_temp_decl ((ValaCCodeBaseModule*) self, cfrag, (ValaList*) vala_ccode_base_module_get_temp_vars ((ValaCCodeBaseModule*) self));
	vala_collection_clear ((ValaCollection*) vala_ccode_base_module_get_temp_vars ((ValaCCodeBaseModule*) self));
	vala_ccode_function_set_block (function, cblock);
	vala_ccode_fragment_append (((ValaCCodeBaseModule*) self)->source_type_member_definition, (ValaCCodeNode*) function);
	_vala_ccode_node_unref0 (cfrag);
	_vala_ccode_node_unref0 (cblock);
	_vala_ccode_node_unref0 (function);
}


static void vala_ccode_struct_module_add_struct_destroy_function (ValaCCodeStructModule* self, ValaStruct* st) {
	char* _tmp0_;
	ValaCCodeFunction* _tmp1_;
	ValaCCodeFunction* function;
	char* _tmp2_;
	char* _tmp3_;
	ValaCCodeFormalParameter* _tmp4_;
	ValaCCodeBlock* cblock;
	g_return_if_fail (self != NULL);
	g_return_if_fail (st != NULL);
	function = (_tmp1_ = vala_ccode_function_new (_tmp0_ = vala_typesymbol_get_destroy_function ((ValaTypeSymbol*) st), "void"), _g_free0 (_tmp0_), _tmp1_);
	if (vala_symbol_get_access ((ValaSymbol*) st) == VALA_SYMBOL_ACCESSIBILITY_PRIVATE) {
		vala_ccode_function_set_modifiers (function, VALA_CCODE_MODIFIERS_STATIC);
	}
	vala_ccode_function_add_parameter (function, _tmp4_ = vala_ccode_formal_parameter_new ("self", _tmp3_ = g_strconcat (_tmp2_ = vala_typesymbol_get_cname ((ValaTypeSymbol*) st, FALSE), "*", NULL)));
	_vala_ccode_node_unref0 (_tmp4_);
	_g_free0 (_tmp3_);
	_g_free0 (_tmp2_);
	cblock = vala_ccode_block_new ();
	vala_ccode_block_add_statement (cblock, (ValaCCodeNode*) ((ValaCCodeBaseModule*) self)->instance_finalize_fragment);
	vala_ccode_function_set_block (function, cblock);
	vala_ccode_fragment_append (((ValaCCodeBaseModule*) self)->source_type_member_definition, (ValaCCodeNode*) function);
	_vala_ccode_node_unref0 (cblock);
	_vala_ccode_node_unref0 (function);
}


ValaCCodeStructModule* vala_ccode_struct_module_construct (GType object_type) {
	ValaCCodeStructModule* self = NULL;
	self = (ValaCCodeStructModule*) vala_ccode_base_module_construct (object_type);
	return self;
}


ValaCCodeStructModule* vala_ccode_struct_module_new (void) {
	return vala_ccode_struct_module_construct (VALA_TYPE_CCODE_STRUCT_MODULE);
}


static void vala_ccode_struct_module_class_init (ValaCCodeStructModuleClass * klass) {
	vala_ccode_struct_module_parent_class = g_type_class_peek_parent (klass);
	VALA_CCODE_BASE_MODULE_CLASS (klass)->generate_struct_declaration = vala_ccode_struct_module_real_generate_struct_declaration;
	VALA_CODE_VISITOR_CLASS (klass)->visit_struct = vala_ccode_struct_module_real_visit_struct;
}


static void vala_ccode_struct_module_instance_init (ValaCCodeStructModule * self) {
}


GType vala_ccode_struct_module_get_type (void) {
	static volatile gsize vala_ccode_struct_module_type_id__volatile = 0;
	if (g_once_init_enter (&vala_ccode_struct_module_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (ValaCCodeStructModuleClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) vala_ccode_struct_module_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ValaCCodeStructModule), 0, (GInstanceInitFunc) vala_ccode_struct_module_instance_init, NULL };
		GType vala_ccode_struct_module_type_id;
		vala_ccode_struct_module_type_id = g_type_register_static (VALA_TYPE_CCODE_BASE_MODULE, "ValaCCodeStructModule", &g_define_type_info, 0);
		g_once_init_leave (&vala_ccode_struct_module_type_id__volatile, vala_ccode_struct_module_type_id);
	}
	return vala_ccode_struct_module_type_id__volatile;
}




