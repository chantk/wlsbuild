From a8b18df4de204d452b1245417ac744b3d765159d Mon Sep 17 00:00:00 2001
From: Vinson Lee <vlee@freedesktop.org>
Date: Wed, 24 Jul 2013 23:28:27 -0700
Subject: [PATCH 2/2] gallivm: Remove NoFramePointerElimNonLeaf for LLVM >=
 3.4.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

TargetOptions::NoFramePointerElimNonLeaf was removed in LLVM 3.4
r187093.

Signed-off-by: Vinson Lee <vlee@freedesktop.org>
Reviewed-by: Jos√© Fonseca <jfonseca@vmware.com>
---
 src/gallium/auxiliary/gallivm/lp_bld_misc.cpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/gallium/auxiliary/gallivm/lp_bld_misc.cpp b/src/gallium/auxiliary/gallivm/lp_bld_misc.cpp
index 2f3020b..5d3e22f 100644
--- a/src/gallium/auxiliary/gallivm/lp_bld_misc.cpp
+++ b/src/gallium/auxiliary/gallivm/lp_bld_misc.cpp
@@ -283,7 +283,9 @@ lp_build_create_jit_compiler_for_module(LLVMExecutionEngineRef *OutJIT,
 #endif
 
 #if defined(DEBUG) || defined(PROFILE)
+#if HAVE_LLVM < 0x0304
    options.NoFramePointerElimNonLeaf = true;
+#endif
    options.NoFramePointerElim = true;
 #endif
 
-- 
1.9.0
