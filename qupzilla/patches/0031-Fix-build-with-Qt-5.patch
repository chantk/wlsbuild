From edc048f5e89394a1f73546565848b4baaa44c580 Mon Sep 17 00:00:00 2001
From: David Rosca <nowrep@gmail.com>
Date: Sat, 1 Aug 2015 21:47:34 +0200
Subject: [PATCH 31/36] Fix build with Qt 5

---
 .travis.yml     | 2 +-
 src/lib/lib.pro | 6 +++++-
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/.travis.yml b/.travis.yml
index a4f20a3..7b02836 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -18,7 +18,7 @@ install:
   - sudo apt-get -qq update
   - sudo apt-get -qq install libssl-dev pkg-config libhunspell-dev
   - if [[ "$QT" == "qt4" ]]; then sudo apt-get -qq install libqt4-dev libqt4-webkit libqt4-sql-sqlite; fi
-  - if [[ "$QT" == "qt5" ]]; then sudo apt-add-repository -y ppa:beineri/opt-qt511; sudo apt-get update -qq; sudo apt-get install -qq qt51base qt51webkit qt51tools qt51script libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev; fi
+  - if [[ "$QT" == "qt5" ]]; then sudo apt-add-repository -y ppa:beineri/opt-qt511; sudo apt-get update -qq; sudo apt-get install -qq qt51base qt51webkit qt51tools qt51script qt51x11extras libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev; fi
 
 script:
   - QMAKE="qmake"
diff --git a/src/lib/lib.pro b/src/lib/lib.pro
index cefac1e..cc77953 100644
--- a/src/lib/lib.pro
+++ b/src/lib/lib.pro
@@ -522,7 +522,11 @@ isEqual(QT_MAJOR_VERSION, 5) {
 
     INSTALLS += target
 
-    !contains(DEFINES, NO_X11):LIBS += -lX11
+    !contains(DEFINES, NO_X11) {
+        LIBS += -lX11
+        QT *= x11extras
+    }
+
     LIBS += -lcrypto
 
     RESOURCES -= data/certs.qrc
-- 
2.5.1

